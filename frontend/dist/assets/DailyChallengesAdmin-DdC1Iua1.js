import{r as s,j as e,b as y,w as X,p as D,T as I,y as M,l as O,Z as B,X as Q}from"./index-9AhYSV_Z.js";import{c as d}from"./challengesApi-BjA6z26s.js";import{D as W}from"./index-DCQZMRM7.js";import{L as u}from"./loader-2-CpwtcwX3.js";import{P as Z}from"./play-DnLT1io8.js";import{C as $}from"./calendar-C7slWmDm.js";import{F as H}from"./flame-0fKfX7LX.js";import{R as Y}from"./refresh-cw-YFwQ7-EY.js";import{P as J}from"./pen-D-TjIoCC.js";import{T as K}from"./trash-2-DRLNEOm3.js";const V=[{value:"quiz",label:"Complete Quizzes",description:"User must complete N quizzes"},{value:"tutorial",label:"Complete Tutorials",description:"User must complete N tutorials"},{value:"course_section",label:"Course Sections",description:"User must complete N course sections"},{value:"typing_game",label:"Typing Games",description:"User must play N typing games"},{value:"typing_wpm",label:"Typing WPM",description:"User must achieve N WPM in a game"},{value:"xp_earn",label:"Earn XP",description:"User must earn N XP"}],P=[{value:"easy",label:"Easy",xpRange:"25-50 XP"},{value:"medium",label:"Medium",xpRange:"50-100 XP"},{value:"hard",label:"Hard",xpRange:"100-200 XP"}],b={title:"",description:"",challenge_type:"quiz",difficulty:"easy",target_count:1,base_xp_reward:50,icon:"target",is_active:!0},xe=()=>{const[o,g]=s.useState([]),[i,f]=s.useState(null),[F,j]=s.useState(!0),[N,k]=s.useState(!1),[h,z]=s.useState(""),[p,E]=s.useState("all"),[R,n]=s.useState(!1),[c,x]=s.useState(null),[t,l]=s.useState(b),[v,w]=s.useState(!1),[C,_]=s.useState(null);s.useEffect(()=>{T()},[]);const T=async()=>{j(!0),_(null);try{const[a,r]=await Promise.all([d.adminGetTemplates(!0),d.adminGetStats()]);g(a),f(r)}catch(a){_("Failed to load challenge data"),console.error(a)}finally{j(!1)}},L=async()=>{k(!0);try{await d.adminGenerateChallenges();const a=await d.adminGetStats();f(a),alert("Daily challenges generated successfully!")}catch(a){alert("Failed to generate challenges"),console.error(a)}finally{k(!1)}},U=a=>{x(a),l({title:a.title,description:a.description||"",challenge_type:a.challenge_type,difficulty:a.difficulty,target_count:a.target_count,base_xp_reward:a.base_xp_reward,icon:a.icon,is_active:a.is_active}),n(!0)},q=()=>{x(null),l(b),n(!0)},A=async a=>{if(confirm(`Delete challenge template "${a.title}"? This cannot be undone.`))try{await d.adminDeleteTemplate(a.id),g(o.filter(r=>r.id!==a.id))}catch(r){alert("Failed to delete template"),console.error(r)}},G=async a=>{a.preventDefault(),w(!0);try{if(c){const r=await d.adminUpdateTemplate(c.id,t);g(o.map(m=>m.id===c.id?r:m))}else{const r=await d.adminCreateTemplate(t);g([...o,r])}n(!1),x(null),l(b)}catch(r){alert("Failed to save template"),console.error(r)}finally{w(!1)}},S=o.filter(a=>{const r=a.title.toLowerCase().includes(h.toLowerCase())||(a.description?.toLowerCase().includes(h.toLowerCase())??!1),m=p==="all"||a.difficulty===p;return r&&m});return F?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-gray-400"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(y,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Daily Challenges"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage challenge templates and monitor system health"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:L,disabled:N,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[N?e.jsx(u,{className:"w-4 h-4 animate-spin"}):e.jsx(Z,{className:"w-4 h-4"}),"Generate Today's Challenges"]}),e.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:[e.jsx(X,{className:"w-4 h-4"}),"New Template"]})]})]})}),i&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 mb-1",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Today's"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.todays_challenges})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 mb-1",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Completions"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.completions_today})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-600 dark:text-purple-400 mb-1",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Templates"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.active_templates})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-600 dark:text-orange-400 mb-1",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Streaks"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.users_with_streaks})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 dark:text-yellow-400 mb-1",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Best Streak"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i.longest_current_streak," days"]})]})]}),C&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg flex items-center gap-2 text-red-700 dark:text-red-400",children:[e.jsx(M,{className:"w-5 h-5"}),C]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search templates...",value:h,onChange:a=>z(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),e.jsxs("select",{value:p,onChange:a=>E(a.target.value),className:"px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Difficulties"}),P.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),e.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx(Y,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Template"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Difficulty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Target"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"XP"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:S.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500 dark:text-gray-400",children:"No templates found. Create your first challenge template!"})}):S.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(y,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.title}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:a.description})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 capitalize",children:a.challenge_type.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${W[a.difficulty]||""}`,children:a.difficulty})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-300",children:a.target_count}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"flex items-center gap-1 text-sm text-yellow-600 dark:text-yellow-400",children:[e.jsx(B,{className:"w-4 h-4"}),a.base_xp_reward]})}),e.jsx("td",{className:"px-6 py-4",children:a.is_active?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded-full",children:[e.jsx(D,{className:"w-3 h-3"}),"Active"]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 rounded-full",children:"Inactive"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>U(a),className:"p-2 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:"Edit",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(a),className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(K,{className:"w-4 h-4"})})]})})]},a.id))})]})})}),R&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:c?"Edit Template":"New Challenge Template"}),e.jsx("button",{onClick:()=>{n(!1),x(null)},className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:G,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:t.title,onChange:a=>l({...t,title:a.target.value}),placeholder:"e.g., Complete 2 Quizzes",className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:a=>l({...t,description:a.target.value}),placeholder:"Optional description",rows:2,className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Challenge Type *"}),e.jsx("select",{required:!0,value:t.challenge_type,onChange:a=>l({...t,challenge_type:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:V.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Difficulty *"}),e.jsx("select",{required:!0,value:t.difficulty,onChange:a=>l({...t,difficulty:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:P.map(a=>e.jsxs("option",{value:a.value,children:[a.label," (",a.xpRange,")"]},a.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Target Count *"}),e.jsx("input",{type:"number",required:!0,min:1,value:t.target_count,onChange:a=>l({...t,target_count:parseInt(a.target.value)||1}),className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Base XP Reward *"}),e.jsx("input",{type:"number",required:!0,min:1,value:t.base_xp_reward,onChange:a=>l({...t,base_xp_reward:parseInt(a.target.value)||50}),className:"w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:t.is_active,onChange:a=>l({...t,is_active:a.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm text-gray-700 dark:text-gray-300",children:"Active (included in daily challenge pool)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:()=>{n(!1),x(null)},className:"px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:v,className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:[v&&e.jsx(u,{className:"w-4 h-4 animate-spin"}),c?"Update":"Create"," Template"]})]})]})]})})]})};export{xe as DailyChallengesAdmin,xe as default};
