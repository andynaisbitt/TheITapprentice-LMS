import{f,r as l,a6 as w,j as e}from"./index-CJMQzWwg.js";const C="https://theitapprentice.com",L=()=>{const j=f(),[a,k]=l.useState([]),[b,c]=l.useState(!0),[x,m]=l.useState(null),[n,g]=l.useState(""),[s,h]=l.useState(null);l.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0),m(null);const d=(await w.get(`${C}/api/v1/admin/users`,{withCredentials:!0})).data.map(async o=>{try{return{user:o,totalStarted:0,totalCompleted:0,totalTimeMinutes:0,recentActivity:null,progressRecords:[]}}catch(y){return console.error(`Failed to fetch progress for user ${o.id}:`,y),{user:o,totalStarted:0,totalCompleted:0,totalTimeMinutes:0,recentActivity:null,progressRecords:[]}}}),i=await Promise.all(d);k(i)}catch(t){console.error("Error fetching user progress:",t),m(t.message||"Failed to load user progress")}finally{c(!1)}},u=a.filter(t=>{const r=`${t.user.first_name} ${t.user.last_name}`.toLowerCase(),d=t.user.email.toLowerCase(),i=n.toLowerCase();return r.includes(i)||d.includes(i)}),N=a.filter(t=>t.totalStarted>0).length;a.filter(t=>t.totalCompleted>0).length;const v=a.length>0?a.reduce((t,r)=>{const d=r.totalStarted>0?r.totalCompleted/r.totalStarted:0;return t+d},0)/a.length*100:0;return b?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):x?e.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-600 dark:text-red-400",children:x}),e.jsx("button",{onClick:p,className:"mt-2 text-sm text-red-700 dark:text-red-300 hover:underline",children:"Try Again"})]})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"User Tutorial Progress"}),e.jsx("p",{className:"mt-1 text-gray-600 dark:text-gray-400",children:"Monitor all users' learning progress and engagement"})]}),e.jsx("button",{onClick:()=>j("/admin/tutorials"),className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:"Back to Management"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:a.length})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Active Learners"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:N})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Completed Tutorials"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:a.reduce((t,r)=>t+r.totalCompleted,0)})]}),e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 border-l-4 border-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Avg Completion Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:[v.toFixed(0),"%"]})]}),e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:n,onChange:t=>g(t.target.value),className:"flex-1 px-4 py-2 border-0 bg-transparent text-gray-900 dark:text-white focus:ring-0"}),n&&e.jsx("button",{onClick:()=>g(""),className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Clear"})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Started"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Completed"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Time Spent"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Recent Activity"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:u.map(t=>{const r=t.totalStarted>0?t.totalCompleted/t.totalStarted*100:0;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsxs("span",{className:"text-white font-semibold text-sm",children:[t.user.first_name?.[0],t.user.last_name?.[0]]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[t.user.first_name," ",t.user.last_name]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.user.email})]})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.totalStarted})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.totalCompleted}),t.totalStarted>0&&e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["(",r.toFixed(0),"%)"]})]})}),e.jsx("td",{className:"px-6 py-4 text-center text-gray-900 dark:text-white font-medium",children:t.totalTimeMinutes>0?`${t.totalTimeMinutes}m`:"-"}),e.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400",children:t.recentActivity?new Date(t.recentActivity).toLocaleDateString():"No activity"}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>h(t),className:"px-3 py-1 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:"View Details"})})]},t.user.id)})})]})}),u.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:n?"No users found matching your search":"No user progress data available"})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[s.user.first_name," ",s.user.last_name]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:s.user.email})]}),e.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tutorials Started"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:s.totalStarted})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:s.totalCompleted})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Time"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:[s.totalTimeMinutes,"m"]})]})]}),s.progressRecords.length>0?e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Tutorial Progress"}),e.jsx("div",{className:"space-y-3",children:s.progressRecords.map((t,r)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.tutorial_title}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.status==="completed"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300"}`,children:t.status==="completed"?"Completed":"In Progress"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${t.status==="completed"?"bg-green-600":"bg-blue-600"}`,style:{width:`${t.progress_percentage}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.progress_percentage,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["Time: ",t.time_spent_minutes,"m"]}),e.jsxs("span",{children:["Started: ",new Date(t.started_at).toLocaleDateString()]}),t.completed_at&&e.jsxs("span",{children:["Completed: ",new Date(t.completed_at).toLocaleDateString()]})]})]},r))})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"This user hasn't started any tutorials yet"})})]})]})}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-300",children:"Backend Integration Required"}),e.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mt-1",children:["To display real user progress data, add a backend endpoint:"," ",e.jsx("code",{className:"bg-yellow-100 dark:bg-yellow-900/40 px-1 rounded",children:"GET /api/v1/admin/users/:user_id/tutorial-progress"})]})]})]})})]})};export{L as UserProgressPage,L as default};
