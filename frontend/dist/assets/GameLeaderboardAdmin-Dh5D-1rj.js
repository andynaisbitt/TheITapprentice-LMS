import{c as L,r,g as C,j as e,x as M,U as P,K as A,e as B,T as y,n as R}from"./index-CJMQzWwg.js";import{L as $}from"./loader-2-DzYHjI--.js";import{D as W}from"./download-DxYpwoY8.js";import{R as G}from"./rotate-ccw-BXA8oXO5.js";import{M as c}from"./medal-Cp2zRaTz.js";const u=L("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),V=()=>{const[o,j]=r.useState([]),[s,b]=r.useState(null),[f,x]=r.useState(!0),[m,g]=r.useState(null),[d,w]=r.useState(""),[i,N]=r.useState("best_wpm"),[n,k]=r.useState("all");r.useEffect(()=>{p()},[i,n]);const p=async()=>{x(!0),g(null);try{const a=await C.get("/api/v1/games/typing/admin/leaderboard",{params:{sort:i,period:n,limit:100}});j(a.data.entries),b(a.data.stats)}catch(a){console.error("Failed to load leaderboard:",a),g("Failed to load leaderboard. Please try again.")}finally{x(!1)}},v=a=>{const t=new Date(a),l=Math.floor((new Date().getTime()-t.getTime())/(1e3*60));return l<60?`${l}m ago`:l<1440?`${Math.floor(l/60)}h ago`:`${Math.floor(l/1440)}d ago`},S=async(a,t)=>{confirm(`Are you sure you want to ban "${t}" from the leaderboard?`)&&alert(`User ${t} has been banned from the leaderboard`)},_=async(a,t)=>{confirm(`Are you sure you want to reset stats for "${t}"? This cannot be undone.`)&&alert(`Stats for ${t} have been reset`)},T=a=>a===1?e.jsx(c,{className:"w-5 h-5 text-yellow-500"}):a===2?e.jsx(c,{className:"w-5 h-5 text-gray-400"}):a===3?e.jsx(c,{className:"w-5 h-5 text-amber-600"}):e.jsx("span",{className:"w-5 h-5 flex items-center justify-center text-sm font-bold text-gray-500",children:a}),h=o.filter(a=>{if(d){const t=d.toLowerCase();if(!a.username.toLowerCase().includes(t)&&!a.email.toLowerCase().includes(t))return!1}return!0});return f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx($,{className:"w-8 h-8 animate-spin text-primary"})}):m?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(M,{className:"w-12 h-12 text-red-500 mb-4"}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4",children:m}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:"Try Again"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Game Leaderboard"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"View and manage typing game rankings"})]}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300",children:[e.jsx(W,{className:"w-4 h-4"}),"Export CSV"]})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.total_players.toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Players"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(A,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.games_played_today}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Games Today"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(B,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[s.avg_wpm_global," WPM"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Global Average"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:e.jsx(y,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[s.top_wpm_today," WPM"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Top Score Today"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by username or email...",value:d,onChange:a=>w(a.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("select",{value:n,onChange:a=>k(a.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"today",children:"Today"})]}),e.jsxs("select",{value:i,onChange:a=>N(a.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"best_wpm",children:"Best WPM"}),e.jsx("option",{value:"avg_wpm",children:"Average WPM"}),e.jsx("option",{value:"games_played",children:"Games Played"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider w-16",children:"Rank"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Player"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Best WPM"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Avg WPM"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Games"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total XP"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Last Played"}),e.jsx("th",{className:"px-4 py-3 w-20"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:h.map(a=>e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700/50 ${a.is_suspicious?"bg-red-50 dark:bg-red-900/10":""}`,children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-center",children:T(a.rank)})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary to-primary-dark flex items-center justify-center text-white text-sm font-semibold",children:a.username[0].toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[a.username,a.is_suspicious&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",children:"Suspicious"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.email})]})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-lg text-primary",children:a.best_wpm})}),e.jsx("td",{className:"px-4 py-4 text-center text-gray-900 dark:text-white",children:a.avg_wpm}),e.jsx("td",{className:"px-4 py-4 text-center text-gray-600 dark:text-gray-300",children:a.games_played}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"text-primary font-medium",children:a.total_xp.toLocaleString()})}),e.jsx("td",{className:"px-4 py-4 text-right text-sm text-gray-500 dark:text-gray-400",children:a.last_played?v(a.last_played):"-"}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>_(a.id,a.username),className:"p-2 text-gray-400 hover:text-yellow-500 transition-colors",title:"Reset Stats",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S(a.id,a.username),className:"p-2 text-gray-400 hover:text-red-500 transition-colors",title:"Ban from Leaderboard",children:e.jsx(u,{className:"w-4 h-4"})})]})})]},a.id))})]})}),h.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No players found"})]})]}),o.some(a=>a.is_suspicious)&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(u,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Suspicious Activity Detected"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"Some players have been flagged for unusually high scores with very few games played. Review and take action if necessary."})]})]})})]})};export{V as GameLeaderboardAdmin,V as default};
