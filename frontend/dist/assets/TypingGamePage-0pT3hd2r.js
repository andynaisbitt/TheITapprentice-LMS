import{u as P,f as S,o as _,r as s,j as e,m as r,K as E,e as L,Z as T,b as R,a3 as $,L as x,T as A,a5 as C}from"./index-9AhYSV_Z.js";import{t as m}from"./typingGameApi-2s0K0Wqv.js";import{R as G}from"./refresh-cw-YFwQ7-EY.js";import{I as D}from"./infinity-B5JVlFv7.js";import{G as M}from"./ghost-BjnyUJuK.js";import{P as F}from"./play-DnLT1io8.js";const q=()=>{const{isAuthenticated:d,user:I}=P(),p=S(),l=_(),[n,f]=s.useState(null),[h,v]=s.useState([]),[y,j]=s.useState(!1),[w,b]=s.useState(!0),[c,u]=s.useState(!1),i=s.useCallback(async(t=!1)=>{t?u(!0):b(!0);try{const[a,o]=await Promise.all([m.getLeaderboard("wpm",5).catch(()=>({entries:[]})),m.getPVPSettings().catch(()=>({pvp_enabled:!1}))]);if(v(a.entries),j(o.pvp_enabled),d){const g=await m.getMyStats();f(g)}}catch(a){console.error("Failed to fetch typing game data:",a)}finally{b(!1),u(!1)}},[d]);s.useEffect(()=>{i()},[i,l.key]),s.useEffect(()=>{const t=()=>{document.visibilityState==="visible"&&i(!0)},a=()=>{i(!0)};return document.addEventListener("visibilitychange",t),window.addEventListener("focus",a),()=>{document.removeEventListener("visibilitychange",t),window.removeEventListener("focus",a)}},[i]),s.useEffect(()=>{l.state?.gameCompleted&&(p(l.pathname,{replace:!0,state:{}}),i(!0))},[l.state,l.pathname,p,i]);const N=()=>{i(!0)},k=[{id:"quick-brown-fox",title:"Quick Brown Fox",description:"3-round progressive challenge",icon:T,color:"from-blue-500 to-purple-600",link:"/games/typing/play"},{id:"infinite-rush",title:"Infinite Rush",description:"60 seconds of pure speed typing",icon:D,color:"from-orange-500 to-red-600",link:"/games/typing/infinite-rush",badge:"New"},{id:"ghost-mode",title:"Ghost Mode",description:"Race against your personal best",icon:M,color:"from-purple-500 to-indigo-600",link:"/games/typing/ghost",badge:"New"},{id:"practice",title:"Practice Mode",description:"Train with custom word lists",icon:R,color:"from-green-500 to-teal-600",link:"/games/typing/practice"},{id:"pvp",title:"PVP Battle",description:y?"Challenge other players":"PVP mode is currently disabled",icon:$,color:"from-red-500 to-orange-600",link:"/games/typing/pvp",badge:y?void 0:"Disabled"}];return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[e.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl mb-4 shadow-lg",children:e.jsx(E,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"Typing Games"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Improve your typing speed and accuracy with fun challenges"})]}),d&&n&&e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-blue-500"}),"Your Stats"]}),e.jsx("button",{onClick:N,disabled:c,className:"p-2 text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors disabled:opacity-50",title:"Refresh stats",children:e.jsx(G,{className:`w-4 h-4 ${c?"animate-spin":""}`})})]}),e.jsxs("div",{className:`grid grid-cols-2 md:grid-cols-4 gap-4 transition-opacity ${c?"opacity-50":""}`,children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:n.best_wpm}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Best WPM"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/30 rounded-lg",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[(n.avg_accuracy??0).toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Accuracy"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 dark:bg-purple-900/30 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:n.total_games_completed}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Games Played"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-900/30 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:n.current_streak_days}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Day Streak"})]})]})]}),e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-8",children:k.map((t,a)=>{const o=t.badge==="Disabled";return e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+a*.05},className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden group hover:shadow-xl transition-shadow",children:[t.badge&&e.jsx("div",{className:`absolute top-3 right-3 text-white text-xs font-bold px-2 py-1 rounded ${t.badge==="New"?"bg-green-500":t.badge==="Hot"?"bg-orange-500":"bg-yellow-500"}`,children:t.badge}),e.jsx("div",{className:`h-2 bg-gradient-to-r ${t.color}`}),e.jsxs("div",{className:"p-5 sm:p-6",children:[e.jsx("div",{className:`w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br ${t.color} rounded-xl flex items-center justify-center mb-3 sm:mb-4 shadow-md`,children:e.jsx(t.icon,{className:"w-6 h-6 sm:w-7 sm:h-7 text-white"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-2",children:t.title}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-4",children:t.description}),e.jsxs(x,{to:o?"#":t.link,className:`inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r ${t.color} text-white rounded-lg font-medium hover:opacity-90 transition-opacity ${o?"opacity-50 cursor-not-allowed":""}`,onClick:g=>o&&g.preventDefault(),children:[e.jsx(F,{className:"w-4 h-4"}),"Play Now"]})]})]},t.id)})}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-yellow-500"}),"Top Players"]}),e.jsx(x,{to:"/games/typing/leaderboard",className:"text-blue-500 hover:text-blue-600 text-sm font-medium",children:"View All"})]}),w?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"space-y-3",children:h.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${a===0?"bg-yellow-500":a===1?"bg-gray-400":a===2?"bg-orange-600":"bg-gray-300"}`,children:a+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.display_name||t.username}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.games_played," games played"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-blue-600 dark:text-blue-400",children:[t.best_wpm," WPM"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[(t.avg_accuracy??0).toFixed(1),"% accuracy"]})]})]},t.user_id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No players yet. Be the first to play!"})]}),!d&&e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl p-8 text-center text-white",children:[e.jsx(C,{className:"w-12 h-12 mx-auto mb-4 opacity-80"}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Track Your Progress"}),e.jsx("p",{className:"mb-4 opacity-90",children:"Sign in to save your scores, compete on leaderboards, and earn achievements!"}),e.jsx(x,{to:"/login",className:"inline-flex items-center gap-2 px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Sign In"})]})]})})};export{q as TypingGamePage,q as default};
