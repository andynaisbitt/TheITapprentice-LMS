import{r as d,j as e,T as Y,q as w,S as v,C as R,m as D,b as q,L as z,s as J}from"./index-smch1bU1.js";import{c as y}from"./challengesApi-sO95NLrf.js";import{D as X}from"./index-DCQZMRM7.js";import{L as S}from"./loader-2-D9MIupjh.js";import{C as B}from"./calendar-D0h1sdek.js";import{F as U}from"./flame-CrTy1GJj.js";import{S as C}from"./sparkles-BWRGzw9b.js";import{C as W}from"./chevron-left-B-a8n3qW.js";const re=()=>{const[l,u]=d.useState([]),[i,_]=d.useState(null),[M,p]=d.useState(!0),[g,b]=d.useState(!1),[j,f]=d.useState(!0),[s,N]=d.useState(new Date);d.useEffect(()=>{F()},[]);const F=async()=>{p(!0);try{const[a,t]=await Promise.all([y.getHistory(50,0),y.getStreak()]);u(a.history),_(t),f(a.has_more)}catch(a){console.error("Failed to load challenge history:",a)}finally{p(!1)}},L=async()=>{if(!(g||!j)){b(!0);try{const a=await y.getHistory(50,l.length);u([...l,...a.history]),f(a.has_more)}catch(a){console.error("Failed to load more history:",a)}finally{b(!1)}}},k=l.reduce((a,t)=>{const r=t.challenge_date;return a[r]||(a[r]=[]),a[r].push(t),a},{}),T=()=>{const a=s.getFullYear(),t=s.getMonth(),r=new Date(a,t,1),n=new Date(a,t+1,0).getDate(),m=r.getDay(),h=[];for(let o=0;o<m;o++)h.push(null);for(let o=1;o<=n;o++)h.push(new Date(a,t,o));return h},x=a=>a.toISOString().split("T")[0],$=a=>{const t=x(a),r=k[t];if(!r)return null;const c=r.filter(m=>m.is_completed).length,n=r.length;return c===n&&n>0?"complete":c>0?"partial":"none"},H=()=>{N(new Date(s.getFullYear(),s.getMonth()-1,1))},P=()=>{N(new Date(s.getFullYear(),s.getMonth()+1,1))},A=["January","February","March","April","May","June","July","August","September","October","November","December"],E=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if(M)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{className:"w-8 h-8 animate-spin text-gray-400"})});const I=l.filter(a=>a.is_completed).length,O=l.reduce((a,t)=>a+(t.xp_earned||0),0);return Object.keys(k).length,e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(B,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Challenge History"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Track your daily challenge progress and streak"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-600 dark:text-orange-400 mb-1",children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Current Streak"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i?.current_streak||0," days"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-600 dark:text-purple-400 mb-1",children:[e.jsx(Y,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Best Streak"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i?.longest_streak||0," days"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 mb-1",children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Completed"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:I})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 dark:text-yellow-400 mb-1",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"XP Earned"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:O.toLocaleString()})]})]}),i&&e.jsx("div",{className:"mb-8 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Freeze Tokens"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Protect your streak when life gets busy"})]})]}),e.jsx("div",{className:"flex gap-1",children:[...Array(3)].map((a,t)=>e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${t<i.freeze_tokens?"bg-blue-100 dark:bg-blue-800":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx(v,{className:`w-4 h-4 ${t<i.freeze_tokens?"text-blue-600 dark:text-blue-400":"text-gray-400"}`})},t))})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-100 dark:border-gray-700 p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[A[s.getMonth()]," ",s.getFullYear()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:H,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsx("button",{onClick:P,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(R,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:E.map(a=>e.jsx("div",{className:"text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2",children:a},a))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:T().map((a,t)=>{if(!a)return e.jsx("div",{className:"aspect-square"},`empty-${t}`);const r=$(a),c=x(a)===x(new Date),n=a>new Date;return e.jsx(D.div,{whileHover:{scale:1.05},className:`aspect-square flex items-center justify-center rounded-lg text-sm font-medium cursor-default transition-colors ${c?"ring-2 ring-orange-500":""} ${n?"text-gray-300 dark:text-gray-600":r==="complete"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":r==="partial"?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:a.getDate()},x(a))})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 dark:bg-green-900/30 rounded"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"All completed"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 dark:bg-yellow-900/30 rounded"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Partial"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-4 h-4 ring-2 ring-orange-500 rounded"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Today"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Challenges"})}),l.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(q,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No challenge history yet"}),e.jsx(z,{to:"/",className:"text-orange-600 dark:text-orange-400 font-medium hover:underline",children:"Start your first challenge"})]}):e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:l.slice(0,20).map((a,t)=>e.jsxs(D.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:t*.05},className:"px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.is_completed?"bg-green-100 dark:bg-green-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:a.is_completed?e.jsx(w,{className:"w-5 h-5 text-green-600 dark:text-green-400"}):e.jsx(J,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:a.challenge_date}),e.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${X[a.difficulty]||""}`,children:a.difficulty})]})]})]}),a.xp_earned>0&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600 dark:text-yellow-400",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-medium",children:["+",a.xp_earned]})]})]},`${a.challenge_id}-${t}`))}),j&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-100 dark:border-gray-700",children:e.jsx("button",{onClick:L,disabled:g,className:"w-full py-2 text-orange-600 dark:text-orange-400 font-medium hover:text-orange-700 dark:hover:text-orange-300 disabled:opacity-50",children:g?e.jsx(S,{className:"w-5 h-5 animate-spin mx-auto"}):"Load more"})})]})]})};export{re as ChallengeHistoryPage,re as default};
