import{c as S,u as q,r as c,j as e,T as m,L as d,C as p,m as h,p as u,q as y,b as C,a5 as T,e as A}from"./index-9AhYSV_Z.js";import{e as D,b as F}from"./useQuizzes-DPr36BgG.js";import{F as $}from"./filter-CCpmtWAD.js";import{C as Q}from"./calendar-C7slWmDm.js";import{C as B}from"./clock-1VZINaTW.js";const L=S("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),I=()=>{const{isAuthenticated:j}=q(),{attempts:o,loading:b}=D(),{stats:a,loading:N}=F(),[r,v]=c.useState("all"),[g,f]=c.useState("date"),[n,w]=c.useState(!0),x=c.useMemo(()=>{let s=[...o];return r==="passed"?s=s.filter(t=>t.passed):r==="failed"&&(s=s.filter(t=>!t.passed)),s.sort((t,i)=>{let l=0;switch(g){case"date":l=new Date(t.completed_at||t.started_at).getTime()-new Date(i.completed_at||i.started_at).getTime();break;case"score":l=t.percentage-i.percentage;break;case"time":l=(t.time_taken_seconds||0)-(i.time_taken_seconds||0);break}return n?-l:l}),s},[o,r,g,n]),k=s=>{if(!s)return"-";const t=Math.floor(s/60),i=s%60;return`${t}:${i.toString().padStart(2,"0")}`},z=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});if(!j)return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(m,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Sign in to view your quiz history"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Track your progress and see how you've improved over time"}),e.jsx(d,{to:"/login",className:"inline-flex items-center px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"Sign In"})]})});const _=b||N;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-200 mb-4",children:[e.jsx(d,{to:"/quizzes",className:"hover:text-white",children:"Quizzes"}),e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{children:"History"})]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Quiz History"}),e.jsx("p",{className:"text-purple-100",children:"Track your quiz attempts and monitor your progress"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a&&e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.total_attempts}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Attempts"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.quizzes_passed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Passed"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-lg flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.quizzes_failed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Failed"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(C,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.average_score.toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Score"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg flex items-center justify-center",children:e.jsx(m,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.best_score.toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Best Score"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.total_xp_earned}),e.jsx("div",{className:"text-xs text-gray-500",children:"XP Earned"})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:r,onChange:s=>v(s.target.value),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"all",children:"All Attempts"}),e.jsx("option",{value:"passed",children:"Passed Only"}),e.jsx("option",{value:"failed",children:"Failed Only"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:g,onChange:s=>f(s.target.value),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"score",children:"Sort by Score"}),e.jsx("option",{value:"time",children:"Sort by Time"})]}),e.jsx("button",{onClick:()=>w(!n),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700",children:n?"↓ Desc":"↑ Asc"})]}),e.jsx("div",{className:"flex-1"}),e.jsx(d,{to:"/quizzes",className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors text-center",children:"Take a Quiz"})]}),_?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):x.length===0?e.jsxs(h.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 bg-white dark:bg-gray-800 rounded-xl shadow-md",children:[e.jsx(m,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:r==="all"?"No quiz attempts yet":`No ${r} attempts`}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r==="all"?"Start taking quizzes to build your history!":"Try adjusting your filters"}),e.jsx(d,{to:"/quizzes",className:"inline-flex items-center px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"Browse Quizzes"})]}):e.jsx("div",{className:"space-y-4",children:x.map((s,t)=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 ${s.passed?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:s.passed?e.jsx(u,{className:"w-6 h-6 text-green-600 dark:text-green-400"}):e.jsx(y,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(d,{to:`/quizzes/${s.quiz_id}`,className:"font-semibold text-gray-900 dark:text-white hover:text-purple-600 dark:hover:text-purple-400 truncate",children:["Quiz #",s.quiz_id.slice(0,8),"..."]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${s.passed?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:s.passed?"Passed":"Failed"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-4 h-4"}),z(s.completed_at||s.started_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"}),k(s.time_taken_seconds)]}),e.jsxs("span",{children:["Attempt #",s.attempt_number]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${s.passed?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[s.percentage.toFixed(0),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.score,"/",s.max_score," pts"]})]}),s.xp_awarded>0&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:["+",s.xp_awarded]}),e.jsx("div",{className:"text-xs text-gray-500",children:"XP"})]}),e.jsx(d,{to:`/quizzes/${s.quiz_id}`,className:"p-2 text-gray-400 hover:text-purple-600 dark:hover:text-purple-400",children:e.jsx(p,{className:"w-5 h-5"})})]})]})},s.id))}),x.length>0&&e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-500 dark:text-gray-400",children:["Showing ",x.length," of ",o.length," attempts"]})]})]})};export{I as default};
