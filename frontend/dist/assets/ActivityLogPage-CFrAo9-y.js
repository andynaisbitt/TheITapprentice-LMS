import{r as l,j as t,l as b,_ as m,N,K as k,T as _,a as A}from"./index-CH_EXTVi.js";import{F as L}from"./filter-Dn0I31l0.js";import{L as S}from"./loader-2-DMEWPFv_.js";import{L as T}from"./log-in-Dm5UP0qO.js";const E=()=>{const[u,o]=l.useState([]),[g,c]=l.useState(!0),[i,p]=l.useState("all"),[n,x]=l.useState("");l.useEffect(()=>{h()},[i]);const h=async()=>{c(!0);try{const e=i!=="all"?`&activity_type=${i}`:"",r=await fetch(`/api/v1/admin/activities?page=1&page_size=50${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!r.ok)throw new Error("Failed to fetch activities");const s=(await r.json()).activities.map(a=>({id:String(a.id),type:a.type||"unknown",title:a.title||"Activity",description:a.description,user:{id:a.user.id,username:a.user.username,avatar:a.user.avatar},timestamp:a.timestamp,xp_earned:a.xp_earned}));o(s)}catch(e){console.error("Failed to load activities:",e),o([])}finally{c(!1)}},f=e=>{switch(e){case"tutorial_complete":return A;case"achievement_unlock":return _;case"typing_game":return k;case"login":return T;case"post_view":return N;default:return m}},v=e=>{switch(e){case"tutorial_complete":return"bg-purple-500";case"achievement_unlock":return"bg-yellow-500";case"typing_game":return"bg-pink-500";case"login":return"bg-green-500";case"post_view":return"bg-blue-500";default:return"bg-gray-500"}},y=e=>{const r=new Date(e),s=Math.floor((new Date().getTime()-r.getTime())/1e3);return s<60?"Just now":s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:r.toLocaleDateString()},w=[{value:"all",label:"All Activities"},{value:"tutorial_complete",label:"Tutorials"},{value:"achievement_unlock",label:"Achievements"},{value:"typing_game",label:"Typing Games"},{value:"login",label:"Logins"}],d=u.filter(e=>!(i!=="all"&&e.type!==i||n&&!e.title.toLowerCase().includes(n.toLowerCase())&&!e.user.username.toLowerCase().includes(n.toLowerCase())));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Activity Log"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"View all user activities across the platform"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(b,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search activities...",value:n,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),t.jsxs("div",{className:"relative",children:[t.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("select",{value:i,onChange:e=>p(e.target.value),className:"pl-10 pr-8 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 appearance-none",children:w.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm",children:g?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(S,{className:"w-8 h-8 animate-spin text-primary"})}):d.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(m,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No activities found"})]}):t.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:d.map(e=>{const r=f(e.type);return t.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:`p-2 rounded-full ${v(e.type)} flex-shrink-0`,children:t.jsx(r,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.title}),e.description&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description}),t.jsxs("div",{className:"flex items-center gap-4 mt-1 text-xs text-gray-400",children:[t.jsxs("span",{children:["@",e.user.username]}),t.jsx("span",{children:y(e.timestamp)}),e.xp_earned&&t.jsxs("span",{className:"text-primary font-medium",children:["+",e.xp_earned," XP"]})]})]})]})},e.id)})})})]})};export{E as ActivityLogPage,E as default};
