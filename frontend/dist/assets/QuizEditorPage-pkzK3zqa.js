import{c as ee,r as h,j as e,A as te,m as U,X as re,y as D,q as H,H as se,o as ae,f as ie,z as le,L as ne}from"./index-smch1bU1.js";import{j as oe,h as de,k as ce,l as xe,m as pe,n as V}from"./useQuizzes-BbP-pkY_.js";import{U as X}from"./upload-D4kN9-I5.js";import{D as Y}from"./download-B6s4gL-Y.js";import{S as me}from"./SkillSelector-BlyRZMr2.js";import"./loader-2-D9MIupjh.js";const G=ee("FileJson",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),K=ee("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),Z=["multiple_choice","multiple_select","true_false","short_answer","code","fill_blank"],ue={questions:[{question_type:"multiple_choice",question_text:"What is the capital of France?",options:[{id:"a",text:"London",is_correct:!1},{id:"b",text:"Paris",is_correct:!0},{id:"c",text:"Berlin",is_correct:!1},{id:"d",text:"Madrid",is_correct:!1}],explanation:"Paris is the capital and largest city of France.",points:1},{question_type:"true_false",question_text:"The Earth is flat.",correct_answer:"false",explanation:"The Earth is an oblate spheroid.",points:1},{question_type:"short_answer",question_text:"What programming language is React written in?",correct_answer:"JavaScript",explanation:"React is a JavaScript library.",points:2}]},ge=`question_type,question_text,option_a,option_b,option_c,option_d,correct_answer,explanation,points
multiple_choice,What is 2+2?,3,4,5,6,b,Basic addition,1
true_false,The sky is blue,,,,,true,Due to Rayleigh scattering,1
short_answer,What is the chemical symbol for water?,,,,,H2O,Water molecule,1`,he=({isOpen:a,onClose:w,onImport:y,quizId:o})=>{const g=h.useRef(null),[b,v]=h.useState("json"),[k,l]=h.useState(""),[x,i]=h.useState([]),[p,c]=h.useState(""),[j,T]=h.useState(!1),[N,M]=h.useState("input"),O=()=>{l(""),i([]),c(""),M("input")},C=()=>{O(),w()},u=t=>{let s,d,n;t==="json"?(s=JSON.stringify(ue,null,2),d="quiz_questions_template.json",n="application/json"):(s=ge,d="quiz_questions_template.csv",n="text/csv");const S=new Blob([s],{type:n}),m=URL.createObjectURL(S),_=document.createElement("a");_.href=m,_.download=d,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(m)},I=t=>{const s=t.target.files?.[0];if(!s)return;const d=new FileReader;d.onload=n=>{const S=n.target?.result;l(S),s.name.endsWith(".json")?v("json"):s.name.endsWith(".csv")&&v("csv")},d.readAsText(s),g.current&&(g.current.value="")},B=t=>{try{const s=JSON.parse(t),d=s.questions||s;if(!Array.isArray(d))throw new Error('JSON must contain a "questions" array or be an array of questions');return d.map((n,S)=>{const m=[];return(!n.question_type||!Z.includes(n.question_type))&&m.push(`Invalid question_type: ${n.question_type||"missing"}`),n.question_text?.trim()||m.push("Missing question_text"),["true_false","short_answer","fill_blank"].includes(n.question_type)&&(n.correct_answer||m.push("Missing correct_answer")),["multiple_choice","multiple_select"].includes(n.question_type)&&(!n.options||!Array.isArray(n.options)||n.options.length<2?m.push("Multiple choice needs at least 2 options"):n.options.some(A=>A.is_correct)||m.push("At least one option must be marked correct")),{question_type:n.question_type||"multiple_choice",question_text:n.question_text||"",options:n.options,correct_answer:n.correct_answer||n.options?.find(_=>_.is_correct)?.id||"",explanation:n.explanation,points:n.points||1,valid:m.length===0,error:m.length>0?m.join(", "):void 0}})}catch(s){throw new Error(`JSON Parse Error: ${s.message}`)}},P=t=>{const s=t.trim().split(`
`);if(s.length<2)throw new Error("CSV must have at least a header row and one data row");const d=s[0].split(",").map(m=>m.trim().toLowerCase()),S=["question_type","question_text","correct_answer"].filter(m=>!d.includes(m));if(S.length>0)throw new Error(`Missing required CSV columns: ${S.join(", ")}`);return s.slice(1).map((m,_)=>{const A=[];let E="",W=!1;for(const z of m)z==='"'?W=!W:z===","&&!W?(A.push(E.trim()),E=""):E+=z;A.push(E.trim());const f={};d.forEach((z,Q)=>{f[z]=A[Q]||""});const q=[],F=f.question_type;Z.includes(F)||q.push(`Invalid question_type: ${F}`),f.question_text||q.push("Missing question_text"),f.correct_answer||q.push("Missing correct_answer");let J;return["multiple_choice","multiple_select"].includes(F)&&(J=["a","b","c","d"].filter(Q=>f[`option_${Q}`]).map(Q=>({id:Q,text:f[`option_${Q}`],is_correct:f.correct_answer?.toLowerCase()===Q})),J.length<2&&q.push("Multiple choice needs at least 2 options")),{question_type:F,question_text:f.question_text,options:J,correct_answer:f.correct_answer,explanation:f.explanation,points:parseInt(f.points)||1,valid:q.length===0,error:q.length>0?q.join(", "):void 0}})},$=()=>{if(c(""),i([]),!k.trim()){c("Please paste or upload content first");return}try{const t=b==="json"?B(k):P(k);i(t),M("preview")}catch(t){c(t.message)}},R=async()=>{const t=x.filter(s=>s.valid);if(t.length===0){c("No valid questions to import");return}T(!0);try{const s=t.map((d,n)=>({question_type:d.question_type,question_text:d.question_text,options:d.options,correct_answer:d.correct_answer,explanation:d.explanation,points:d.points,order_index:n}));await y(s),C()}catch(s){c(s.message||"Failed to import questions")}finally{T(!1)}},L=x.filter(t=>t.valid).length,r=x.filter(t=>!t.valid).length;return e.jsx(te,{children:a&&e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:C}),e.jsxs(U.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(X,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Import Questions"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Bulk import questions from JSON or CSV"})]})]}),e.jsx("button",{onClick:C,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg transition",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[N==="input"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>u("json"),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx(G,{className:"w-4 h-4"}),"Download JSON Template"]}),e.jsxs("button",{onClick:()=>u("csv"),className:"flex items-center gap-2 px-4 py-2 bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-lg hover:bg-green-100 dark:hover:bg-green-900/50 transition",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx(K,{className:"w-4 h-4"}),"Download CSV Template"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Import Format"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>v("json"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition ${b==="json"?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx(G,{className:"w-4 h-4"}),"JSON"]}),e.jsxs("button",{onClick:()=>v("csv"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition ${b==="csv"?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx(K,{className:"w-4 h-4"}),"CSV"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center cursor-pointer hover:border-purple-500 dark:hover:border-purple-500 transition",onClick:()=>g.current?.click(),children:[e.jsx(X,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:b==="json"?".json files":".csv files"})]}),e.jsx("input",{ref:g,type:"file",accept:b==="json"?".json":".csv",onChange:I,className:"hidden"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Or Paste Content"}),e.jsx("textarea",{value:k,onChange:t=>l(t.target.value),rows:10,placeholder:b==="json"?`{
  "questions": [...]
}`:"question_type,question_text,...",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),p&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(D,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:p})]})]}),N==="preview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 dark:bg-green-900/30 rounded-lg",children:[e.jsx(H,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("span",{className:"font-medium text-green-700 dark:text-green-400",children:[L," valid"]})]}),r>0&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-50 dark:bg-red-900/30 rounded-lg",children:[e.jsx(D,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e.jsxs("span",{className:"font-medium text-red-700 dark:text-red-400",children:[r," invalid"]})]})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:x.map((t,s)=>e.jsx("div",{className:`p-4 rounded-lg border ${t.valid?"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-medium px-2 py-0.5 bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded",children:t.question_type.replace("_"," ")}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.points," pt",t.points!==1?"s":""]})]}),e.jsx("p",{className:"text-gray-900 dark:text-white text-sm",children:t.question_text||"(empty question)"}),t.options&&t.options.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["Options: ",t.options.map(d=>d.text).join(" | ")]}),t.error&&e.jsx("p",{className:"mt-2 text-xs text-red-600 dark:text-red-400",children:t.error})]}),e.jsx("div",{className:"flex-shrink-0",children:t.valid?e.jsx(H,{className:"w-5 h-5 text-green-600 dark:text-green-400"}):e.jsx(D,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})]})},s))}),p&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(D,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:p})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"Download a template to see the expected format"})]}),e.jsxs("div",{className:"flex gap-3",children:[N==="preview"&&e.jsx("button",{onClick:()=>M("input"),className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:"Back"}),e.jsx("button",{onClick:C,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:"Cancel"}),N==="input"?e.jsx("button",{onClick:$,disabled:!k.trim(),className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Parse & Preview"}):e.jsx("button",{onClick:R,disabled:j||L===0,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4"}),"Import ",L," Question",L!==1?"s":""]})})]})]})]})]})})},ye=[{value:"multiple_choice",label:"Multiple Choice"},{value:"multiple_select",label:"Multiple Select"},{value:"true_false",label:"True/False"},{value:"short_answer",label:"Short Answer"},{value:"code",label:"Code"},{value:"fill_blank",label:"Fill in the Blank"}],be=["easy","medium","hard","expert"],Ce=()=>{const{id:a}=ae(),w=ie(),y=!!a,{quiz:o,loading:g,refetch:b}=oe(a),[v,k]=h.useState(!1),[l,x]=h.useState("details"),[i,p]=h.useState({id:"",title:"",description:"",instructions:"",category:"",tags:[],difficulty:"medium",time_limit_minutes:void 0,passing_score:70,max_attempts:0,question_order:"sequential",show_answers_after:!0,allow_review:!0,xp_reward:50,xp_perfect:100,status:"draft",is_featured:!1,related_skills:[],questions:[]}),[c,j]=h.useState(null),[T,N]=h.useState(!1),[M,O]=h.useState(!1),{toast:C}=le();h.useEffect(()=>{o&&p({id:o.id,title:o.title,description:o.description||"",instructions:o.instructions||"",category:o.category||"",tags:o.tags||[],difficulty:o.difficulty,time_limit_minutes:o.time_limit_minutes||void 0,passing_score:o.passing_score,max_attempts:o.max_attempts,question_order:o.question_order,show_answers_after:o.show_answers_after,allow_review:o.allow_review,xp_reward:o.xp_reward,xp_perfect:o.xp_perfect,status:o.status,is_featured:o.is_featured,related_skills:o.related_skills||[]})},[o]);const u=r=>{const{name:t,value:s,type:d}=r.target;p(n=>({...n,[t]:d==="number"?s?parseInt(s):void 0:s}))},I=r=>{const{name:t,checked:s}=r.target;p(d=>({...d,[t]:s}))},B=async()=>{if(!i.title.trim()){alert("Please enter a quiz title");return}if(!y&&!i.id.trim()){alert("Please enter a quiz ID");return}k(!0);try{y?await de(a,i):await ce(i),w("/admin/quizzes")}catch(r){alert(r.response?.data?.detail||"Failed to save quiz")}finally{k(!1)}},P=r=>{j(r?{id:r.id,question_type:r.question_type,question_text:r.question_text,question_html:r.question_html,options:r.options,correct_answer:r.correct_answer,explanation:r.explanation,code_language:r.code_language,code_template:r.code_template,points:r.points,image_url:r.image_url}:{question_type:"multiple_choice",question_text:"",options:[{id:"a",text:"",is_correct:!1},{id:"b",text:"",is_correct:!1},{id:"c",text:"",is_correct:!1},{id:"d",text:"",is_correct:!1}],correct_answer:"",points:1}),N(!0)},$=async()=>{if(!(!c||!a)){if(!c.question_text?.trim()){alert("Please enter a question text");return}if(c.question_type==="multiple_choice"||c.question_type==="multiple_select"){if(!c.options?.some(s=>s.is_correct)){alert("Please select at least one correct answer");return}if(c.options?.some(s=>!s.text?.trim())){alert("Please fill in all answer options");return}}if(c.question_type==="true_false"&&!c.correct_answer){alert("Please select the correct answer (True or False)");return}if((c.question_type==="short_answer"||c.question_type==="fill_blank")&&!c.correct_answer){alert("Please enter the correct answer");return}try{c.id?await pe(c.id,c):await V(a,c),N(!1),j(null),b()}catch(r){alert(r.response?.data?.detail||"Failed to save question")}}},R=async r=>{if(confirm("Are you sure you want to delete this question?"))try{await xe(r),b()}catch(t){alert(t.response?.data?.detail||"Failed to delete question")}},L=async r=>{if(!a)return;let t=0,s=0;for(const d of r)try{await V(a,d),t++}catch(n){s++,console.error("Failed to import question:",n)}b(),s===0?C.success(`Successfully imported ${t} question${t!==1?"s":""}`):C.warning(`Imported ${t} questions, ${s} failed`)};return y&&g?e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ne,{to:"/admin/quizzes",className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y?"Edit Quiz":"Create Quiz"}),y&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["ID: ",a]})]})]}),e.jsx("button",{onClick:B,disabled:v,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Quiz"]})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:e.jsxs("nav",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>x("details"),className:`pb-3 px-1 border-b-2 font-medium text-sm ${l==="details"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Quiz Details"}),y&&e.jsxs("button",{onClick:()=>x("questions"),className:`pb-3 px-1 border-b-2 font-medium text-sm ${l==="questions"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:["Questions (",o?.question_count||0,")"]})]})}),l==="details"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Basic Information"}),!y&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quiz ID *"}),e.jsx("input",{type:"text",name:"id",value:i.id,onChange:u,placeholder:"e.g., python-basics-quiz",className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL-friendly identifier (no spaces)"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",name:"title",value:i.title,onChange:u,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:i.description,onChange:u,rows:3,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Instructions"}),e.jsx("textarea",{name:"instructions",value:i.instructions,onChange:u,rows:2,placeholder:"Instructions shown before starting the quiz",className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsx("input",{type:"text",name:"category",value:i.category,onChange:u,placeholder:"e.g., Programming",className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Difficulty"}),e.jsx("select",{name:"difficulty",value:i.difficulty,onChange:u,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:be.map(r=>e.jsx("option",{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Quiz Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Time Limit (minutes)"}),e.jsx("input",{type:"number",name:"time_limit_minutes",value:i.time_limit_minutes||"",onChange:u,placeholder:"No limit",className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Passing Score (%)"}),e.jsx("input",{type:"number",name:"passing_score",value:i.passing_score,onChange:u,min:0,max:100,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Attempts (0 = unlimited)"}),e.jsx("input",{type:"number",name:"max_attempts",value:i.max_attempts,onChange:u,min:0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Question Order"}),e.jsxs("select",{name:"question_order",value:i.question_order,onChange:u,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"sequential",children:"Sequential"}),e.jsx("option",{value:"random",children:"Random"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"show_answers_after",checked:i.show_answers_after,onChange:I,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show correct answers after completion"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"allow_review",checked:i.allow_review,onChange:I,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Allow reviewing answers"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"XP Rewards"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"XP for Passing"}),e.jsx("input",{type:"number",name:"xp_reward",value:i.xp_reward,onChange:u,min:0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"XP for Perfect Score"}),e.jsx("input",{type:"number",name:"xp_perfect",value:i.xp_perfect,onChange:u,min:0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),e.jsx(me,{selectedSlugs:i.related_skills||[],onChange:r=>p(t=>({...t,related_skills:r})),helpText:"Skills that will receive XP when this quiz is passed"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Publishing"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:i.status,onChange:u,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"is_featured",checked:i.is_featured,onChange:I,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Featured quiz"})]})]}),!y&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"Note:"})," Save the quiz first, then you can add questions."]})})]})]}),l==="questions"&&y&&o&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["Questions (",o.questions.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>O(!0),className:"px-4 py-2 border border-purple-600 text-purple-600 dark:text-purple-400 rounded-lg hover:bg-purple-50 dark:hover:bg-purple-900/20 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Import"]}),e.jsxs("button",{onClick:()=>P(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Question"]})]})]}),o.questions.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No questions yet. Add your first question!"}),e.jsx("button",{onClick:()=>P(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Add Question"})]}):e.jsx("div",{className:"space-y-4",children:o.questions.map((r,t)=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("span",{className:"flex-shrink-0 w-8 h-8 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-full flex items-center justify-center font-bold",children:t+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded capitalize",children:r.question_type.replace("_"," ")}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.points," point",r.points!==1?"s":""]})]}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:r.question_text}),r.options.length>0&&e.jsx("div",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:r.options.map(s=>s.text).join(" | ")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>P(r),className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>R(r.id),className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},r.id))})]}),T&&c&&e.jsx(fe,{question:c,onChange:j,onSave:$,onClose:()=>{N(!1),j(null)}}),a&&e.jsx(he,{isOpen:M,onClose:()=>O(!1),onImport:L,quizId:a})]})},fe=({question:a,onChange:w,onSave:y,onClose:o})=>{const g=(l,x)=>{w({...a,[l]:x})},b=(l,x,i)=>{const p=[...a.options||[]];p[l]={...p[l],[x]:i},x==="is_correct"&&i&&a.question_type==="multiple_choice"?(p.forEach((c,j)=>{j!==l&&(c.is_correct=!1)}),w({...a,options:p,correct_answer:p[l].id})):w({...a,options:p})},v=()=>{const l=new Set(a.options?.map(i=>i.id)||[]);let x="a";for(let i=0;i<26;i++){const p=String.fromCharCode(97+i);if(!l.has(p)){x=p;break}}w({...a,options:[...a.options||[],{id:x,text:"",is_correct:!1}]})},k=l=>{w({...a,options:a.options?.filter((x,i)=>i!==l)})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.id?"Edit Question":"Add Question"}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Question Type"}),e.jsx("select",{value:a.question_type,onChange:l=>g("question_type",l.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:ye.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Question Text *"}),e.jsx("textarea",{value:a.question_text||"",onChange:l=>g("question_text",l.target.value),rows:3,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(a.question_type==="multiple_choice"||a.question_type==="multiple_select")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Answer Options"}),e.jsx("div",{className:"space-y-2",children:a.options?.map((l,x)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:a.question_type==="multiple_choice"?"radio":"checkbox",checked:l.is_correct,onChange:i=>b(x,"is_correct",i.target.checked),className:"text-purple-600"}),e.jsx("input",{type:"text",value:l.text,onChange:i=>b(x,"text",i.target.value),placeholder:`Option ${l.id.toUpperCase()}`,className:"flex-1 px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsx("button",{onClick:()=>k(x),className:"p-2 text-red-600 hover:bg-red-100 rounded",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},x))}),e.jsx("button",{onClick:v,className:"mt-2 text-sm text-purple-600 hover:text-purple-700",children:"+ Add Option"})]}),a.question_type==="true_false"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Correct Answer"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:a.correct_answer==="true",onChange:()=>g("correct_answer","true"),className:"text-purple-600"}),e.jsx("span",{children:"True"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:a.correct_answer==="false",onChange:()=>g("correct_answer","false"),className:"text-purple-600"}),e.jsx("span",{children:"False"})]})]})]}),(a.question_type==="short_answer"||a.question_type==="fill_blank")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Correct Answer(s)"}),e.jsx("input",{type:"text",value:Array.isArray(a.correct_answer)?a.correct_answer.join(", "):a.correct_answer||"",onChange:l=>g("correct_answer",l.target.value),placeholder:"Separate multiple acceptable answers with commas",className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Explanation (shown after answering)"}),e.jsx("textarea",{value:a.explanation||"",onChange:l=>g("explanation",l.target.value),rows:2,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Points"}),e.jsx("input",{type:"number",value:a.points||1,onChange:l=>g("points",parseInt(l.target.value)||1),min:1,className:"w-32 px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Save Question"})]})]})})})};export{Ce as default};
