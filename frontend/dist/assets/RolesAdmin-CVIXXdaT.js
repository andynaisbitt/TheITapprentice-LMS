import{r as d,j as e,w,I as v,S as C,U as S,F as E}from"./index-CH_EXTVi.js";import{L as R}from"./loader-2-DMEWPFv_.js";import{P as _}from"./pen-DH6aCffj.js";import{T as P}from"./trash-2-CEmDLHiu.js";const g=[{id:"blog.create",name:"Create Posts",description:"Create blog posts",category:"Content"},{id:"blog.edit",name:"Edit Posts",description:"Edit own blog posts",category:"Content"},{id:"blog.edit_all",name:"Edit All Posts",description:"Edit any blog post",category:"Content"},{id:"blog.delete",name:"Delete Posts",description:"Delete blog posts",category:"Content"},{id:"blog.publish",name:"Publish Posts",description:"Publish/unpublish posts",category:"Content"},{id:"pages.manage",name:"Manage Pages",description:"Create, edit, delete pages",category:"Content"},{id:"users.view",name:"View Users",description:"View user list",category:"Users"},{id:"users.edit",name:"Edit Users",description:"Edit user profiles",category:"Users"},{id:"users.delete",name:"Delete Users",description:"Delete user accounts",category:"Users"},{id:"users.roles",name:"Manage Roles",description:"Assign roles to users",category:"Users"},{id:"tutorials.manage",name:"Manage Tutorials",description:"CRUD tutorials",category:"LMS"},{id:"courses.manage",name:"Manage Courses",description:"CRUD courses",category:"LMS"},{id:"games.manage",name:"Manage Games",description:"Manage typing games",category:"LMS"},{id:"settings.view",name:"View Settings",description:"View site settings",category:"System"},{id:"settings.edit",name:"Edit Settings",description:"Modify site settings",category:"System"},{id:"plugins.manage",name:"Manage Plugins",description:"Enable/disable plugins",category:"System"}],M=[{id:"admin",name:"Administrator",description:"Full system access",permissions:g.map(i=>i.id),user_count:1,is_system:!0},{id:"editor",name:"Editor",description:"Can manage content but not users or settings",permissions:["blog.create","blog.edit","blog.edit_all","blog.delete","blog.publish","pages.manage","tutorials.manage","courses.manage"],user_count:3,is_system:!0},{id:"author",name:"Author",description:"Can create and edit own content",permissions:["blog.create","blog.edit"],user_count:5,is_system:!0},{id:"subscriber",name:"Subscriber",description:"Basic user with learning access",permissions:[],user_count:150,is_system:!0}],F=()=>{const[i,l]=d.useState([]),[p,x]=d.useState(!0),[u,c]=d.useState(!1),[o,m]=d.useState(null),[r,n]=d.useState({name:"",description:"",permissions:[]});d.useEffect(()=>{y()},[]);const y=async()=>{x(!0);try{l(M)}catch(s){console.error("Failed to load roles:",s)}finally{x(!1)}},b=s=>{m(s),n({name:s.name,description:s.description,permissions:[...s.permissions]}),c(!0)},h=async s=>{if(i.find(a=>a.id===s)?.is_system){alert("System roles cannot be deleted");return}confirm("Are you sure you want to delete this role?")&&l(i.filter(a=>a.id!==s))},f=s=>{n(t=>({...t,permissions:t.permissions.includes(s)?t.permissions.filter(a=>a!==s):[...t.permissions,s]}))},j=async()=>{if(o)l(i.map(s=>s.id===o.id?{...s,name:r.name,description:r.description,permissions:r.permissions}:s));else{const s={id:r.name.toLowerCase().replace(/\s+/g,"_"),name:r.name,description:r.description,permissions:r.permissions,user_count:0,is_system:!1};l([...i,s])}c(!1),m(null),n({name:"",description:"",permissions:[]})},k=g.reduce((s,t)=>(s[t.category]||(s[t.category]=[]),s[t.category].push(t),s),{});return p?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Roles & Permissions"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage user roles and their access permissions"})]}),e.jsxs("button",{onClick:()=>{m(null),n({name:"",description:"",permissions:[]}),c(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:[e.jsx(w,{className:"w-4 h-4"}),"Add Role"]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"Roles define what actions users can perform. System roles (Administrator, Editor, Author, Subscriber) cannot be deleted but their permissions can be modified."})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(s=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.id==="admin"?"bg-red-100 dark:bg-red-900/30":s.id==="editor"?"bg-blue-100 dark:bg-blue-900/30":s.id==="author"?"bg-green-100 dark:bg-green-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx(C,{className:`w-5 h-5 ${s.id==="admin"?"text-red-600 dark:text-red-400":s.id==="editor"?"text-blue-600 dark:text-blue-400":s.id==="author"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>b(s),className:"p-2 text-gray-400 hover:text-primary transition-colors",children:e.jsx(_,{className:"w-4 h-4"})}),!s.is_system&&e.jsx("button",{onClick:()=>h(s.id),className:"p-2 text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(P,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-gray-500 dark:text-gray-400",children:[e.jsx(S,{className:"w-4 h-4"}),s.user_count," users"]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[s.permissions.length," permissions"]})]}),s.permissions.length>0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[s.permissions.slice(0,5).map(t=>{const a=g.find(N=>N.id===t);return e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:a?.name||t},t)}),s.permissions.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-500",children:["+",s.permissions.length-5," more"]})]})]},s.id))}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:o?"Edit Role":"Create New Role"})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Role Name"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>n({...r,name:s.target.value}),disabled:o?.is_system,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50",placeholder:"e.g., Moderator"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:r.description,onChange:s=>n({...r,description:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Brief description of this role"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Permissions"}),e.jsx("div",{className:"space-y-4",children:Object.entries(k).map(([s,t])=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:s}),e.jsx("div",{className:"space-y-2",children:t.map(a=>e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer",children:[e.jsx("button",{type:"button",onClick:()=>f(a.id),className:`w-5 h-5 rounded flex items-center justify-center transition-colors ${r.permissions.includes(a.id)?"bg-primary text-white":"border-2 border-gray-300 dark:border-gray-600"}`,children:r.permissions.includes(a.id)&&e.jsx(E,{className:"w-3 h-3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.description})]})]},a.id))})]},s))})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{c(!1),m(null)},className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:!r.name,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:opacity-50",children:o?"Save Changes":"Create Role"})]})]})})]})};export{F as RolesAdmin,F as default};
