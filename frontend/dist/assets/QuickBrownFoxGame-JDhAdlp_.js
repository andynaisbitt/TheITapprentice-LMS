import{r as l,j as e,m as r,u as De,K as Pe,x as Ie,M as Fe,Z as L,q as Je,A as Ee,T as Be,b as be,e as Ge}from"./index-CH_EXTVi.js";import{t as R}from"./typingGameApi-DeLeUFq8.js";import{u as Le}from"./useTypingEngine-B036qq_F.js";import{u as $e,a as We,b as Ue,S as Oe,C as Ke,W as Ve}from"./SoundSettings-N1pn3PZL.js";import{S as ye}from"./StreakDisplay-DE_-Qy0m.js";import{D as ae}from"./DailyChallengeCard-BR1cvqtn.js";import{R as fe}from"./RegistrationPrompt-CIgB8nS2.js";import{u as Xe}from"./useRegistrationPrompt-BS_vcVyy.js";import{P as He}from"./play-BHEkGL37.js";import{G as je}from"./gift-B7SBJtUy.js";import{F as se}from"./flame-Dm-WfBw5.js";import{C as we}from"./clock-BTGHFX1q.js";import{A as Qe}from"./arrow-left-CTJyzdxq.js";import{C as ve}from"./check-circle-2-BHOKl1-o.js";import{R as ke}from"./rotate-ccw-BzvJj0pt.js";import{S as Ze}from"./star-BISlQTdL.js";import{S as Ye}from"./sparkles-xvle3ljW.js";const et=({progress:c,isPlaying:o,className:y=""})=>{const i=c>=60&&c<=80,C=i?(c-60)/20:0,m=i?Math.sin(C*Math.PI)*30:0;return l.useMemo(()=>o?Math.floor(c*4%4):0,[c,o]),e.jsxs("div",{className:`relative w-full h-16 overflow-hidden ${y}`,children:[e.jsx("div",{className:"absolute bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-green-400 via-green-500 to-green-400 rounded-full opacity-60"}),e.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-between px-4",children:[...Array(12)].map((g,u)=>e.jsx("div",{className:"w-1 h-2 bg-green-500 rounded-t-full opacity-40",style:{transform:`rotate(${(u%2===0?-1:1)*10}deg)`}},u))}),e.jsx(r.div,{className:"absolute bottom-3",style:{left:"70%",transform:"translateX(-50%)"},animate:{y:i?[0,-2,0]:0},transition:{duration:.3},children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-10 h-6 bg-amber-600 rounded-lg relative",children:[e.jsxs("div",{className:"absolute -left-3 -top-1 w-5 h-5 bg-amber-700 rounded-full",children:[e.jsx("div",{className:"absolute -top-1 left-0 w-2 h-3 bg-amber-800 rounded-full transform -rotate-12"}),e.jsx("div",{className:"absolute top-1.5 left-2.5 w-1 h-1 bg-black rounded-full",children:i&&e.jsx("div",{className:"absolute inset-0 bg-amber-700 rounded-full"})}),e.jsx("div",{className:"absolute bottom-0 left-1 w-3 h-2 bg-amber-600 rounded-b-lg"})]}),e.jsx(r.div,{className:"absolute -right-2 top-0 w-3 h-2 bg-amber-700 rounded-full origin-left",animate:{rotate:i?[0,20,0]:[-5,5,-5]},transition:{duration:.5,repeat:1/0}}),e.jsx("div",{className:"absolute bottom-0 left-1 w-2 h-2 bg-amber-700 rounded-b"}),e.jsx("div",{className:"absolute bottom-0 right-1 w-2 h-2 bg-amber-700 rounded-b"})]}),!i&&c<60&&e.jsxs(r.div,{className:"absolute -top-4 -right-2 text-xs text-gray-400 font-bold",animate:{opacity:[.3,1,.3],y:[0,-2,0]},transition:{duration:1.5,repeat:1/0},children:["z",e.jsx("span",{className:"text-[10px]",children:"z"}),e.jsx("span",{className:"text-[8px]",children:"z"})]}),c>=50&&c<60&&e.jsx(r.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},className:"absolute -top-5 left-1/2 -translate-x-1/2 text-yellow-500 font-bold text-sm",children:"!"})]})}),e.jsx(r.div,{className:"absolute bottom-3",style:{left:`${Math.min(c,95)}%`,transform:"translateX(-50%)"},animate:{y:-m,rotate:i?[0,-10,0,10,0]:0},transition:{y:{duration:.1},rotate:{duration:.2}},children:e.jsxs("div",{className:"relative",children:[e.jsxs(r.div,{className:"w-8 h-5 bg-orange-500 rounded-lg relative",animate:{scaleX:o?[1,1.1,1]:1},transition:{duration:.15,repeat:o?1/0:0},children:[e.jsxs("div",{className:"absolute -right-2 -top-1 w-4 h-4 bg-orange-600 rounded-full",children:[e.jsx("div",{className:"absolute -top-2 left-0 w-1.5 h-2.5 bg-orange-700 rounded-t-full transform -rotate-12"}),e.jsx("div",{className:"absolute -top-2 right-0 w-1.5 h-2.5 bg-orange-700 rounded-t-full transform rotate-12"}),e.jsx("div",{className:"absolute top-1 right-1 w-1.5 h-1.5 bg-black rounded-full",children:e.jsx("div",{className:"absolute top-0 right-0 w-0.5 h-0.5 bg-white rounded-full"})}),e.jsx("div",{className:"absolute bottom-0 right-0 w-2 h-1.5 bg-white rounded-r-lg"}),e.jsx("div",{className:"absolute bottom-0.5 right-0 w-1 h-1 bg-black rounded-full"})]}),e.jsx("div",{className:"absolute bottom-0 right-1 w-3 h-2 bg-white rounded-t-lg opacity-80"}),e.jsx(r.div,{className:"absolute -left-3 top-0 w-4 h-3 bg-orange-600 rounded-full origin-right",animate:{rotate:o?[-20,20,-20]:0},transition:{duration:.2,repeat:o?1/0:0},children:e.jsx("div",{className:"absolute left-0 top-0.5 w-1.5 h-2 bg-white rounded-full"})}),e.jsx(r.div,{className:"absolute bottom-0 left-1 w-1.5 h-3 bg-orange-700 rounded-b origin-top",animate:{rotate:o&&!i?[-30,30,-30]:i?-45:0},transition:{duration:.1,repeat:o&&!i?1/0:0}}),e.jsx(r.div,{className:"absolute bottom-0 left-3 w-1.5 h-3 bg-orange-700 rounded-b origin-top",animate:{rotate:o&&!i?[30,-30,30]:i?-30:0},transition:{duration:.1,repeat:o&&!i?1/0:0}}),e.jsx(r.div,{className:"absolute bottom-0 right-2 w-1.5 h-3 bg-orange-700 rounded-b origin-top",animate:{rotate:o&&!i?[-20,20,-20]:i?30:0},transition:{duration:.1,repeat:o&&!i?1/0:0}}),e.jsx(r.div,{className:"absolute bottom-0 right-0.5 w-1.5 h-3 bg-orange-700 rounded-b origin-top",animate:{rotate:o&&!i?[20,-20,20]:i?45:0},transition:{duration:.1,repeat:o&&!i?1/0:0}})]}),o&&c>10&&!i&&e.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full",children:[...Array(3)].map((g,u)=>e.jsx(r.div,{className:"h-0.5 bg-orange-300 rounded-full mb-1",style:{width:`${8-u*2}px`,marginLeft:`${u*3}px`},animate:{opacity:[.3,.7,.3]},transition:{duration:.2,delay:u*.05,repeat:1/0}},u))}),i&&e.jsx(e.Fragment,{children:e.jsx(r.div,{className:"absolute -top-2 left-1/2 text-yellow-400 text-xs",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1,y:-5},transition:{duration:.2},children:"✨"})})]})}),c>=90&&e.jsx(r.div,{className:"absolute bottom-3 right-2",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},children:e.jsx("div",{className:"w-1 h-8 bg-gray-600 rounded-t",children:e.jsx(r.div,{className:"absolute top-0 left-1 w-4 h-3 bg-gradient-to-br from-white via-black to-white bg-[length:4px_4px]",style:{backgroundImage:"repeating-conic-gradient(#000 0% 25%, #fff 0% 50%)",backgroundSize:"4px 4px"},animate:{x:[0,2,0]},transition:{duration:.5,repeat:1/0}})})}),e.jsxs("div",{className:"absolute top-0 right-2 text-xs text-gray-400 font-mono",children:[Math.round(c),"%"]})]})},k=[{roundNumber:1,name:"Warmup",timeLimit:null,description:"Get familiar with the words. Take your time!"},{roundNumber:2,name:"Speed Challenge",timeLimit:25,description:"Complete within 25 seconds!"},{roundNumber:3,name:"INSANE MODE",timeLimit:12,description:"12 seconds - Type fast or fail!"}],Ne={1:["The quick brown fox jumps over the lazy dog","Pack my box with five dozen liquor jugs","How vexingly quick daft zebras jump","The five boxing wizards jump quickly","Jackdaws love my big sphinx of quartz","Sphinx of black quartz judge my vow","Two driven jocks help fax my big quiz","The jay pig fox zebra and my wolves quack","Sympathizing would fix Quaker objectives","A wizard job is to vex chumps quickly in fog","Watch Jeopardy and Alex Trebek is famous for his quizzing voice","Crazy Frederick bought many very exquisite opal jewels","We promptly judged antique ivory buckles for the next prize","A mad boxer shot a quick gloved jab to the jaw of his dizzy opponent","Jaded zombies acted quaintly but kept driving their oxen forward","The quick onyx goblin jumps over the lazy dwarf","Few quips galvanized the mock jury box","Quick zephyrs blow vexing daft Jim","Waltz bad nymph for quick jigs vex","Glib jocks quiz nymph to vex dwarf"],2:["The quick brown fox jumped swiftly over the sleeping lazy dog","A quick movement of the enemy will jeopardize six gunboats","All questions asked by five watch experts amazed the judge","Jack quietly moved up front and seized the big ball of wax","Just keep examining every low bid quoted for zinc etchings","My girl wove six dozen plaid jackets before she quit","Sixty zippers were quickly picked from the woven jute bag","Amazingly few discotheques provide jukeboxes","Heavy boxes perform quick waltzes and jigs","Jinxed wizards pluck ivy from the big quilt","The fox was quick and brown as it leaped over the lazy dog","Big July earthquakes confound zany experimental vow","Foxy parsons quiz and cajole the lovably dim wiki user","Have a pick of jab combo and execute wild zig zag left moves","Cozy lummox gives smart squid who asks for job pen","A large fawn jumped quickly over white zinc boxes","Viewing quizzical abstracts mixed up hefty jocks","Brawny gods just flocked up to quiz and vex him","Adjusting quiver and bow Zephyr killed the fox","My faxed joke won a pager in the cable TV quiz show"],3:["Quick wafting zephyrs vex bold Jim","Sphinx of black quartz judge my vow","How quickly daft jumping zebras vex","The five boxing wizards jump quickly","Jackdaws love my big sphinx of quartz","Pack my box with five dozen jugs","Waltz bad nymph for quick jigs vex","Glib jocks quiz nymph to vex dwarf","Quick fox jumps nightly above wizard","The jay pig fox zebra and wolves quack","Vexed nymphs go for quick waltz job","Blowzy night frumps vex had quick","Glum Schwartzkopf vexd by NJ IQ","Vext cwm fly zing jabs Kurd qoph","Jump dogs quiz for why blank vetch","Fox nymphs grab quick lived waltz","Brick quiz whangs jumpy veldt fox","Bright vixens jump dozy fowl quack","Quick wafting zephyrs vex bold Jim","Lazy movers quit hard packing of jewelry boxes"]},Ce=({onComplete:c,seconds:o})=>{const[y,x]=l.useState(o);return l.useEffect(()=>{if(y<=0){c();return}const q=setTimeout(()=>x(A=>A-1),1e3);return()=>clearTimeout(q)},[y,c]),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(r.div,{initial:{scale:1.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},transition:{duration:.3,type:"spring",damping:15},className:"text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-purple-600",children:y},y),e.jsx("div",{className:"relative w-16 h-1 mt-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx(r.div,{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full",initial:{width:"100%"},animate:{width:"0%"},transition:{duration:o,ease:"linear"}})})]})},ft=({onComplete:c,onExit:o,wordListId:y})=>{const{isAuthenticated:x}=De(),{isPromptOpen:q,closePrompt:A,handleSkip:i,showPrompt:C}=Xe({context:"game",onSkip:()=>{}}),m=$e(),[g,u]=l.useState("idle"),[d,re]=l.useState(0),[le,ne]=l.useState(""),[$,_e]=l.useState(null),[p,Se]=l.useState(null),[f,ie]=l.useState([]),[M,F]=l.useState(null),[oe,ze]=l.useState(""),[de,ce]=l.useState(""),[J,me]=l.useState(null),[E,W]=l.useState([]),[U,xe]=l.useState(null),[Te,ue]=l.useState(!1),[Re,O]=l.useState(!1),D=l.useRef(null),_=l.useRef(null),P=l.useRef(null),K=l.useRef(!1),w=k[d],B=l.useCallback(t=>{const a=Ne[t]||Ne[1];return a[Math.floor(Math.random()*a.length)]},[]),V=l.useRef("none"),{wordStates:v,currentWordIndex:I,currentInput:S,stats:N,maxCombo:G,getCharacterStates:qe,handleKeyDown:ge,handlePaste:Ae,reset:pe}=Le(le,{onWordComplete:(t,a,s)=>{const n=v[t];n&&ce(T=>T+(T?" ":"")+n.typedValue),a&&m.playMilestone()},onGameComplete:t=>{m.playGameEnd(),Q(!0)},onError:(t,a,s,n)=>{m.playError(),h.breakCombo(),b.recordKeystroke()},onKeystroke:t=>{b.recordKeystroke(t.timestamp),t.isCorrect&&(h.increment(),m.playKeystroke());const a=h.tier;a!==V.current&&a!=="none"&&(m.playCombo(h.combo),V.current=a)}}),b=We({enabled:!0,onSuspiciousActivity:t=>{console.log("[Anti-Cheat] Suspicious activity:",t)}}),h=Ue({onComboMilestone:(t,a)=>{console.log(`[Combo] Milestone reached: ${t} (${a})`)},onComboBreak:(t,a)=>{console.log(`[Combo] Broken at ${t}, max was ${a}`)},onTierUp:(t,a)=>{console.log(`[Combo] Tier up to ${t} at ${a}`)}}),z=l.useCallback(()=>{const t=a=>{if(!(a<=0)){if(D.current&&(D.current.focus(),document.activeElement===D.current)){D.current.scrollIntoView({behavior:"smooth",block:"center"});return}setTimeout(()=>t(a-1),100)}};setTimeout(()=>t(5),50)},[]),X=l.useCallback(async()=>{let t="";try{const s=await R.startGame({...y?{word_list_id:y}:{},mode:"challenge",word_count:9});_e(s),ze(s.checksum),s.text&&s.text.trim().length>10&&(t=s.text)}catch(s){console.error("Failed to start game session:",s)}re(0),ie([]);const a=t||B(1);ne(a),u("ready")},[y,B]),H=l.useCallback(()=>{pe(),h.reset(),b.reset(),b.startTracking(),V.current="none",ce(""),P.current=Date.now();const t=k[d];t.timeLimit?F(t.timeLimit):F(null),m.playGameStart(),u("playing"),z()},[d,pe,h,b,z,m]),Q=l.useCallback(t=>{_.current&&(clearInterval(_.current),_.current=null),b.stopTracking();const a=P.current?(Date.now()-P.current)/1e3:0,s={round:d+1,wpm:N.wpm,accuracy:N.accuracy,time:Math.round(a*10)/10,passed:t,maxCombo:Math.max(G,h.maxCombo)};ie(n=>[...n,s]),t?d>=k.length-1?Me():u("round_complete"):u("failed")},[d,N,G,h.maxCombo,b]),he=l.useCallback(()=>{const t=v.filter(a=>a.status==="completed"||a.status==="skipped").map(a=>a.typedValue).join(" ");return S&&I<v.length?t+(t?" ":"")+S:t||de},[v,S,I,de]),Z=l.useCallback(async()=>{if(x)try{const t=await R.getDailyChallenges();me(t.streak),W(t.challenges)}catch(t){console.error("Failed to refresh streak/challenges:",t)}},[x]),Me=l.useCallback(async()=>{if(!$){u("game_complete");return}const t=he(),a=b.getAntiCheatData(),s={session_id:$.session_id,user_input:t,time_elapsed:Math.round(N.timeElapsed),checksum:oe,max_combo:Math.max(G,h.maxCombo),anti_cheat:{keystroke_timings:a.keystrokeTimings,keystroke_count:a.keystrokeCount,paste_attempts:a.pasteAttempts,focus_lost_count:a.focusLostCount,total_focus_lost_time:a.totalFocusLostTime,first_segment_avg:a.firstSegmentAvg,last_segment_avg:a.lastSegmentAvg}};try{const n=await R.submitGameV2(s);(n.is_personal_best_wpm||n.is_personal_best_accuracy)&&(m.playPersonalBest(),ue(!0),setTimeout(()=>ue(!1),5e3)),n.challenges_completed&&n.challenges_completed.length>0&&m.playChallengeComplete(),Se(n),u("game_complete"),c?.(n),Z()}catch(n){console.error("Failed to submit results:",n),u("game_complete")}},[$,he,N.timeElapsed,oe,G,h.maxCombo,b,c,m,Z]),Y=l.useCallback(()=>{const t=d+1;re(t);const a=B(t+1);ne(a),u("ready")},[d,B]);l.useEffect(()=>{if(g==="playing"&&w?.timeLimit)return _.current=setInterval(()=>{const t=P.current?(Date.now()-P.current)/1e3:0,a=w.timeLimit-t;a<=0?(F(0),Q(!1)):F(Math.ceil(a))},100),()=>{_.current&&clearInterval(_.current)}},[g,w,Q]),l.useEffect(()=>{g==="playing"&&(O(!0),z())},[g,z]),l.useEffect(()=>{x&&(async()=>{try{const a=await R.getDailyChallenges();me(a.streak),W(a.challenges)}catch(a){console.error("Failed to fetch streak/challenges:",a)}})()},[x]);const ee=l.useCallback(async t=>{xe(t);try{(await R.claimChallengeReward(t)).success&&(W(s=>s.map(n=>n.challenge_id===t?{...n,is_claimed:!0}:n)),m.playChallengeComplete())}catch(a){console.error("Failed to claim challenge:",a)}finally{xe(null)}},[m]),te=l.useCallback((t,a=!1)=>{if((t.ctrlKey||t.metaKey)&&t.key.toLowerCase()==="v"){t.preventDefault(),b.recordPasteAttempt();return}a||(K.current=!0),ge(t)},[ge,b]),j=l.useMemo(()=>f.length===0?{wpm:0,accuracy:0,maxCombo:0}:{wpm:Math.round(f.reduce((t,a)=>t+a.wpm,0)/f.length),accuracy:Math.round(f.reduce((t,a)=>t+a.accuracy,0)/f.length),maxCombo:Math.max(...f.map(t=>t.maxCombo))},[f]);if(g==="idle"){const t=E.filter(s=>s.is_completed&&!s.is_claimed),a=E.filter(s=>!s.is_completed);return e.jsx("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"md:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx(Pe,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2 text-gray-900 dark:text-white",children:"Quick Brown Fox Challenge"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Word-by-word typing with combo system. No going back!"})]}),e.jsx("div",{className:"space-y-3 mb-6",children:k.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`
                      w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm
                      ${n===0?"bg-green-500":n===1?"bg-yellow-500":"bg-red-500"}
                    `,children:s.roundNumber}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:s.name})]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.timeLimit?`${s.timeLimit}s limit`:"No limit"})]},n))}),!x&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6 text-left",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ie,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm",children:"Playing as guest. Scores won't be saved."}),e.jsxs("button",{onClick:C,className:"mt-2 text-sm font-medium text-yellow-700 dark:text-yellow-300 hover:underline flex items-center gap-1",children:[e.jsx(Fe,{className:"w-4 h-4"}),"Sign up to track progress"]})]})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:X,className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold text-lg hover:from-blue-600 hover:to-purple-700 transition-all flex items-center gap-2 mx-auto",children:[e.jsx(He,{className:"w-5 h-5"}),"Start Challenge"]})})]}),e.jsxs(r.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},className:"space-y-4",children:[x&&J&&e.jsx(ye,{streak:J,onUseFreeze:async()=>{try{await R.useStreakFreeze(),Z()}catch(s){console.error("Failed to use freeze:",s)}}}),x&&E.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-amber-500"}),"Daily Challenges"]}),e.jsxs("div",{className:"space-y-3",children:[t.map(s=>e.jsx(ae,{challenge:s,onClaim:ee,claiming:U===s.challenge_id},s.challenge_id)),a.slice(0,2).map(s=>e.jsx(ae,{challenge:s,onClaim:ee,claiming:U===s.challenge_id},s.challenge_id))]}),a.length>2&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:["+",a.length-2," more challenges"]})]}),!x&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-gray-800 dark:to-gray-900 rounded-xl p-4 border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Build your streak!"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Sign up to track your daily streak, complete challenges, and earn XP rewards."}),e.jsx("button",{onClick:C,className:"w-full py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Get Started Free"})]})]})]})})}if(g==="ready")return e.jsx("div",{className:"max-w-3xl mx-auto p-2 sm:p-4 md:p-6",children:e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8 text-center",children:[e.jsxs(r.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},className:`
              inline-flex items-center gap-2 px-4 py-2 rounded-full mb-4 text-white font-bold text-lg
              bg-gradient-to-r
              ${d===0?"from-green-500 to-emerald-600":d===1?"from-yellow-500 to-orange-600":"from-red-500 to-rose-600"}
            `,children:[e.jsx(L,{className:"w-5 h-5"}),"Round ",d+1,": ",w.name]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-3 text-sm",children:[w.description,w.timeLimit&&e.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 text-orange-500 font-medium",children:[e.jsx(we,{className:"w-3.5 h-3.5"}),w.timeLimit,"s limit"]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-3 mb-5",children:e.jsx("p",{className:"font-mono text-base sm:text-lg text-gray-600 dark:text-gray-400 line-clamp-2",children:le})}),d>0?e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ce,{onComplete:H,seconds:3}),e.jsx("button",{onClick:H,className:"px-6 py-2 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Start Now →"})]}):e.jsxs("button",{onClick:H,className:"px-8 py-3 bg-green-500 text-white rounded-lg font-semibold text-lg hover:bg-green-600 transition-all flex items-center gap-2 mx-auto",children:[e.jsx(L,{className:"w-5 h-5"}),"GO!"]})]})});if(g==="playing")return e.jsx("div",{className:"max-w-3xl mx-auto p-2 sm:p-4 md:p-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-3 sm:p-4 md:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx("button",{onClick:o,className:"p-1.5 sm:p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Exit game",children:e.jsx(Qe,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsxs("div",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900 dark:text-white",children:["Round ",d+1,": ",e.jsx("span",{className:"hidden sm:inline",children:w.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"hidden xs:block",children:e.jsx(Oe,{settings:m.settings,onToggleSound:m.toggleSound,onVolumeChange:m.setVolume,compact:!0})}),M!==null&&e.jsxs(r.div,{className:`text-lg sm:text-xl md:text-2xl font-bold tabular-nums ${M<=5?"text-red-500":"text-blue-500"}`,animate:M<=5?{scale:[1,1.1,1]}:{},transition:{duration:.5,repeat:M<=5?1/0:0},children:[M,"s"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1.5 sm:gap-2 md:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsx("div",{className:"text-base sm:text-lg md:text-2xl font-bold text-blue-600 dark:text-blue-400 tabular-nums",children:N.wpm}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"WPM"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsxs("div",{className:"text-base sm:text-lg md:text-2xl font-bold text-green-600 dark:text-green-400 tabular-nums",children:[N.accuracy,"%"]}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"Acc"})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsxs("div",{className:"text-base sm:text-lg md:text-2xl font-bold text-purple-600 dark:text-purple-400 tabular-nums",children:[I,"/",v.length]}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"Words"})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsx(Ke,{comboState:h.state,showMaxCombo:!1,size:"sm"}),!h.state.isActive&&e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"Combo"})]})]}),e.jsx(et,{progress:v.length>0?I/v.length*100:0,isPlaying:g==="playing",className:"mb-3 sm:mb-4 bg-gradient-to-b from-sky-100 to-green-50 dark:from-sky-900/20 dark:to-green-900/20 rounded-lg"}),e.jsxs("div",{className:"relative",children:[!Re&&g==="playing"&&e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 z-10 flex items-center justify-center bg-gray-900/40 dark:bg-gray-900/60 backdrop-blur-[2px] rounded-xl cursor-pointer",onClick:z,children:e.jsx("div",{className:"text-white text-lg font-medium bg-gray-900/80 px-6 py-3 rounded-lg",children:"Click here to continue typing"})}),e.jsx(Ve,{words:v,currentWordIndex:I,currentInput:S,getCharacterStates:qe,onContainerClick:z,className:"mb-2 sm:mb-3 md:mb-4"}),e.jsx("input",{ref:D,type:"text",inputMode:"text",enterKeyHint:"next",value:S,onKeyDown:te,onPaste:Ae,onChange:t=>{if(K.current){K.current=!1;return}const a=t.target.value,s=S;if(a.length>s.length){const n=a.slice(s.length);for(const T of n)te({key:T,preventDefault:()=>{}},!0)}else a.length<s.length&&te({key:"Backspace",preventDefault:()=>{}},!0)},onFocus:()=>O(!0),onBlur:()=>O(!1),className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-default",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-gramm":"false","data-gramm_editor":"false","data-enable-grammarly":"false","aria-label":"Type the words shown above"})]}),e.jsxs("p",{className:"text-center text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("span",{className:"hidden sm:inline",children:"Click the text area and start typing. Press "}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-[10px] sm:text-xs",children:"Space"}),e.jsx("span",{className:"hidden sm:inline",children:" to move to next word"}),e.jsx("span",{className:"sm:hidden",children:" = next word"})]})]})});if(g==="round_complete"){const t=f[f.length-1],a=d>=k.length-1;return e.jsx("div",{className:"max-w-3xl mx-auto p-2 sm:p-4 md:p-6",children:e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:`bg-gradient-to-r ${d===0?"from-green-500 to-emerald-600":d===1?"from-yellow-500 to-orange-600":"from-red-500 to-rose-600"} p-4 text-white`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-6 h-6"}),e.jsxs("span",{className:"font-bold text-lg",children:["Round ",d+1," Complete"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-white/90",children:[e.jsxs("span",{className:"font-bold",children:[t?.wpm||0," ",e.jsx("span",{className:"text-xs font-normal opacity-80",children:"WPM"})]}),e.jsxs("span",{className:"font-bold",children:[t?.accuracy||0,"% ",e.jsx("span",{className:"text-xs font-normal opacity-80",children:"ACC"})]}),e.jsxs("span",{className:"font-bold",children:[t?.maxCombo||0,"x ",e.jsx("span",{className:"text-xs font-normal opacity-80",children:"COMBO"})]})]})]})}),!a&&e.jsxs("div",{className:"p-5 text-center",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Next up"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mt-1",children:k[d+1]?.name}),k[d+1]?.timeLimit&&e.jsxs("div",{className:"flex items-center justify-center gap-1 text-orange-500 text-sm mt-1",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsxs("span",{children:[k[d+1].timeLimit,"s time limit"]})]})]}),e.jsx(Ce,{onComplete:Y,seconds:3}),e.jsx("button",{onClick:Y,className:"mt-3 px-6 py-2 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Skip →"})]}),a&&e.jsx("div",{className:"p-5 text-center",children:e.jsx("button",{onClick:Y,className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold text-lg hover:from-blue-600 hover:to-purple-700 transition-all",children:"See Results"})})]})})}if(g==="failed")return e.jsx("div",{className:"max-w-2xl mx-auto p-4 sm:p-6",children:e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8 text-center",children:[e.jsx(Je,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Time's Up!"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["You didn't complete Round ",d+1," in time."]}),e.jsx("div",{className:"flex gap-4 justify-center",children:e.jsxs("button",{onClick:X,className:"px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-all flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"Try Again"]})})]})});if(g==="game_complete"){const t=E.filter(s=>s.is_completed&&!s.is_claimed),a=p?.is_personal_best_wpm||p?.is_personal_best_accuracy;return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 relative",children:[e.jsx(Ee,{children:Te&&e.jsx("div",{className:"fixed inset-0 pointer-events-none z-50 overflow-hidden",children:[...Array(50)].map((s,n)=>e.jsx(r.div,{initial:{opacity:1,y:-20,x:Math.random()*window.innerWidth,rotate:0},animate:{opacity:0,y:window.innerHeight+100,rotate:Math.random()*720-360},exit:{opacity:0},transition:{duration:2+Math.random()*2,delay:Math.random()*.5,ease:"easeOut"},className:`absolute w-3 h-3 ${["bg-yellow-400","bg-purple-500","bg-blue-500","bg-green-500","bg-pink-500","bg-orange-500"][Math.floor(Math.random()*6)]} ${Math.random()>.5?"rounded-full":"rounded-sm"}`},n))})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"md:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8 text-center",children:[a?e.jsxs(r.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",damping:10},className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(r.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0},className:"w-24 h-24 bg-yellow-400/30 rounded-full blur-xl"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"w-16 h-16 text-yellow-500 mx-auto mb-2",fill:"currentColor"}),e.jsx(Ye,{className:"w-8 h-8 text-yellow-400 absolute -top-2 -right-2"})]})]}):e.jsx(Be,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),e.jsx(r.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.15,type:"spring",damping:12},className:"mb-2",children:(()=>{const s=j.wpm>=80?"S":j.wpm>=60?"A":j.wpm>=45?"B":j.wpm>=30?"C":"D",n={S:"from-yellow-400 via-amber-500 to-orange-500",A:"from-green-400 to-emerald-500",B:"from-blue-400 to-cyan-500",C:"from-gray-400 to-gray-500",D:"from-red-400 to-red-500"},T={S:"Lightning Fingers!",A:"Speed Demon!",B:"Solid Typist!",C:"Keep Practicing!",D:"Room to Grow!"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`inline-block text-5xl font-black bg-gradient-to-br ${n[s]} bg-clip-text text-transparent`,children:s}),e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:T[s]})]})})()}),e.jsx("h2",{className:"text-3xl font-bold mb-2 text-gray-900 dark:text-white",children:a?"New Personal Best!":"Challenge Complete!"}),a&&e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex flex-wrap justify-center gap-2 mb-4",children:[p?.is_personal_best_wpm&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg",children:[e.jsx(L,{className:"w-4 h-4"}),"Best WPM"]}),p?.is_personal_best_accuracy&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-gradient-to-r from-green-400 to-emerald-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg",children:[e.jsx(be,{className:"w-4 h-4"}),"Best Accuracy"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 my-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-4",children:[e.jsx(Ge,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:j.wpm}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg WPM"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-lg p-4",children:[e.jsx(be,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),e.jsxs("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[j.accuracy,"%"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Accuracy"})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-lg p-4",children:[e.jsx(L,{className:"w-6 h-6 text-orange-500 mx-auto mb-2"}),e.jsxs("div",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:[j.maxCombo,"x"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Best Combo"})]})]}),x&&e.jsxs(r.div,{initial:{scale:0,y:-30},animate:{scale:1,y:0},transition:{delay:.4,type:"spring",damping:8},className:"bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/30 dark:to-indigo-900/30 border border-purple-200 dark:border-purple-700 rounded-xl p-5 mb-6 relative overflow-hidden",children:[e.jsx(r.div,{animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 bg-gradient-to-r from-purple-400/10 via-indigo-400/20 to-purple-400/10"}),e.jsxs("div",{className:"relative",children:[e.jsxs(r.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6,type:"spring"},className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-indigo-600 dark:from-purple-400 dark:to-indigo-400",children:["+",p?.xp_earned??Math.round(j.wpm*2.5)," XP"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:p?.streak?.streak_bonus_xp&&p.streak.streak_bonus_xp>0?e.jsxs(r.span,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"inline-flex items-center gap-1 text-orange-500 font-medium",children:[e.jsx(se,{className:"w-4 h-4"}),"Includes +",p.streak.streak_bonus_xp," streak bonus!"]}):"Experience Earned"})]})]}),!x&&e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"text-xl font-bold text-purple-400/60 line-through mb-1",children:["+",Math.round(j.wpm*2.5)," XP"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sign up to earn XP and track your progress!"}),e.jsx("button",{onClick:C,className:"mt-2 text-sm font-medium text-purple-600 dark:text-purple-400 hover:underline",children:"Create free account →"})]}),e.jsx("div",{className:"space-y-2 mb-6",children:f.map((s,n)=>e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg gap-1",children:[e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["Round ",s.round]}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[s.wpm," WPM | ",s.accuracy,"% | ",s.time,"s | ",s.maxCombo,"x"]})]},n))}),e.jsxs("button",{onClick:X,className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold text-lg hover:from-blue-600 hover:to-purple-700 transition-all flex items-center gap-2 mx-auto",children:[e.jsx(ke,{className:"w-5 h-5"}),"Play Again"]})]}),e.jsxs(r.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"space-y-4",children:[x&&J&&e.jsxs("div",{className:"relative",children:[p?.streak?.streak_extended&&e.jsx(r.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded-full z-10",children:"+1 Day!"}),e.jsx(ye,{streak:J})]}),x&&t.length>0&&e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 rounded-xl p-4 border border-amber-200 dark:border-amber-800",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-amber-500"}),"Challenges Completed!"]}),e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsx(ae,{challenge:s,onClaim:ee,claiming:U===s.challenge_id},s.challenge_id))})]}),p?.challenges_completed&&p.challenges_completed.length>0&&e.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.5},className:"bg-green-50 dark:bg-green-900/30 rounded-xl p-4 border border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ve,{className:"w-5 h-5 text-green-500"}),e.jsxs("span",{className:"font-semibold text-green-700 dark:text-green-300",children:[p.challenges_completed.length," Challenge",p.challenges_completed.length>1?"s":""," Completed!"]})]}),e.jsx("div",{className:"space-y-1",children:p.challenges_completed.map((s,n)=>e.jsxs("div",{className:"flex justify-between text-sm text-green-600 dark:text-green-400",children:[e.jsx("span",{children:s.challenge_type.replace("_"," ")}),e.jsxs("span",{children:["+",s.xp_reward," XP"]})]},n))})]}),!x&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-gray-800 dark:to-gray-900 rounded-xl p-4 border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Track your progress!"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Sign up to build streaks, complete challenges, and climb the leaderboard."}),e.jsx("button",{onClick:C,className:"w-full py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Create Free Account"})]})]})]}),e.jsx(fe,{isOpen:q,onClose:A,onSkip:i,context:"game"})]})}return e.jsx(fe,{isOpen:q,onClose:A,onSkip:i,context:"game"})};export{ft as Q};
