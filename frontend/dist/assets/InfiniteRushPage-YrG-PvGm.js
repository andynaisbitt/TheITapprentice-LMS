import{u as De,r as s,j as e,m as l,Z,b as J,x as Pe,M as Te,A as $e,T as ze,e as Ee,K as Fe,f as Be}from"./index-CJMQzWwg.js";import{t as D}from"./typingGameApi-DQemIh-W.js";import{u as Ge,b as Ve,a as Ke,S as Oe,C as Le,W as Ue}from"./SoundSettings-DJ-iDF81.js";import{S as fe}from"./StreakDisplay-vIbLix9M.js";import{D as He}from"./DailyChallengeCard-BXWgQnCb.js";import{R as be}from"./RegistrationPrompt-66Ql1RUD.js";import{u as qe}from"./useRegistrationPrompt-D1sRSL6q.js";import{I as Q}from"./infinity-CTu6KDk8.js";import{C as je}from"./clock-Bq85wjS9.js";import{P as Xe}from"./play-BZVFUr9-.js";import{F as Y}from"./flame-n_pYayva.js";import{A as Ze}from"./arrow-left-BnHh0bgQ.js";import{S as Je}from"./star-DaWJHMcR.js";import{S as Qe}from"./sparkles-d34NXF22.js";import{R as Ye}from"./rotate-ccw-BXA8oXO5.js";import"./gift-DUP6G1PY.js";import"./loader-2-DzYHjI--.js";import"./log-in-C0o3wH86.js";const N=60,ke=12,we=6,P={easy:["server","code","data","file","user","port","host","node","link","path","root","admin","cache","query","token","hash","stack","heap","queue","array","loop","func","class","type","debug","build","test","push","pull","merge","branch","commit","docker","nginx","redis","mongo","mysql","linux","python","react","cloud","azure","proxy","route","state","props","hooks","async"],medium:["function","variable","database","endpoint","protocol","network","frontend","backend","security","container","cluster","pipeline","compiler","debugger","terminal","keyboard","interface","component","developer","architect","engineer","incident","deployment","monitoring","kubernetes","terraform","ansible","grafana","elastic","firebase","typescript","javascript","microservice","middleware","authentication","encryption","certificate","firewall","bandwidth","throughput"],hard:["infrastructure","configuration","implementation","optimization","virtualization","orchestration","containerization","authentication","authorization","serialization","deserialization","asynchronous","synchronization","parallelization","multithreading","concurrency"]},ve=f=>{const u=[],o=[...P.easy,...P.medium];for(let b=0;b<f;b++)Math.random()<.2&&P.hard.length>0?u.push(P.hard[Math.floor(Math.random()*P.hard.length)]):u.push(o[Math.floor(Math.random()*o.length)]);return u},et=f=>f.map((u,o)=>({word:u,index:o,status:o===0?"current":"pending",typedValue:"",isCorrect:!0,characterStates:u.split("").map(b=>({char:b,status:"pending",typedChar:void 0}))})),tt=({onComplete:f,seconds:u})=>{const[o,b]=s.useState(u);return s.useEffect(()=>{if(o<=0){f();return}const C=setTimeout(()=>b(S=>S-1),1e3);return()=>clearTimeout(C)},[o,f]),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(l.div,{initial:{scale:1.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},transition:{duration:.3,type:"spring",damping:15},className:"text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-600",children:o},o),e.jsx("div",{className:"relative w-16 h-1 mt-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx(l.div,{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-orange-500 to-red-600 rounded-full",initial:{width:"100%"},animate:{width:"0%"},transition:{duration:u,ease:"linear"}})})]})},at=({onComplete:f,onExit:u})=>{const{isAuthenticated:o}=De(),{isPromptOpen:b,closePrompt:C,handleSkip:S,showPrompt:G}=qe({context:"game",onSkip:()=>{}}),m=Ge(),[k,V]=s.useState("idle"),[g,M]=s.useState([]),[i,ee]=s.useState(0),[y,T]=s.useState(""),[v,te]=s.useState(N),[$,Ne]=s.useState(null),[_,Ce]=s.useState(null),[Se,K]=s.useState(!1),[z,ae]=s.useState(0),[E,se]=s.useState(0),[re,ne]=s.useState(0),[w,oe]=s.useState(0),[O,le]=s.useState(100),[F,_e]=s.useState(null),[ie,de]=s.useState([]),[Re,ce]=s.useState(null),[Ae,me]=s.useState(!1),B=s.useRef(null),R=s.useRef(null),L=s.useRef(null),Me=s.useRef(null),U=s.useRef(!1),H=s.useRef(0),p=Ve({onComboMilestone:(t,a)=>{console.log(`[Combo] Milestone reached: ${t} (${a})`)},onComboBreak:(t,a)=>{console.log(`[Combo] Broken at ${t}, max was ${a}`)},onTierUp:(t,a)=>{console.log(`[Combo] Tier up to ${t} at ${a}`),m.playCombo(a)}}),j=Ke({enabled:!0,onSuspiciousActivity:t=>{console.log("[Anti-Cheat] Suspicious activity:",t)}}),A=s.useCallback(()=>{B.current&&setTimeout(()=>{B.current?.focus(),B.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},[]),q=s.useCallback(t=>{const a=g[t];if(!a)return[];const{word:n,typedValue:r,status:d}=a,h=[];if(d==="completed"||d==="skipped")return a.characterStates;if(d==="current"){for(let c=0;c<n.length;c++)c<r.length?h.push({char:n[c],status:r[c]===n[c]?"correct":"incorrect",typedChar:r[c]}):h.push({char:n[c],status:"pending"});if(r.length>n.length)for(let c=n.length;c<r.length;c++)h.push({char:r[c],status:"extra",typedChar:r[c]});return h}return n.split("").map(c=>({char:c,status:"pending"}))},[g]),xe=s.useCallback(()=>{const a=ve(we).map(n=>(H.current+=1,{word:n,index:H.current,status:"pending",typedValue:"",isCorrect:!0,characterStates:n.split("").map(r=>({char:r,status:"pending",typedChar:void 0}))}));M(n=>[...n,...a])},[]),ue=s.useCallback(()=>{if(!L.current)return;const t=(Date.now()-L.current)/1e3/60;if(t<=0)return;const a=Math.round(E/5/t);oe(a);const n=E+re,r=n>0?Math.round(E/n*100):100;le(r)},[E,re]),ge=s.useCallback(t=>{if(i>=g.length)return;const a=g[i];M(x=>{const I=[...x];return I[i]={...a,status:"completed",isCorrect:t,characterStates:q(i)},I[i+1]&&(I[i+1]={...I[i+1],status:"current"}),I});const n=a.word.length,r=y.length;let d=0,h=0;for(let x=0;x<Math.max(n,r);x++)x<n&&x<r?a.word[x]===y[x]?d++:h++:x<r&&h++;se(x=>x+d),ne(x=>x+h),ae(x=>x+1),ee(x=>x+1),T(""),t?(m.playMilestone(),p.increment()):(m.playError(),p.breakCombo()),g.length-i-1<we&&xe()},[i,g,y,q,m,p,xe]),X=s.useCallback((t,a=!1)=>{if(k!=="playing")return;if((t.ctrlKey||t.metaKey)&&t.key.toLowerCase()==="v"){t.preventDefault(),j.recordPasteAttempt();return}a||(U.current=!0);const n=Date.now();if(Me.current=n,j.recordKeystroke(n),t.key===" "){if(t.preventDefault(),y.length>0){const r=g[i],d=r&&y===r.word;ge(d)}return}if(t.key==="Backspace"){T(r=>r.slice(0,-1)),M(r=>{const d=[...r];return d[i]&&(d[i]={...d[i],typedValue:y.slice(0,-1)}),d});return}if(t.key.length===1){const r=y+t.key;T(r),M(h=>{const c=[...h];return c[i]&&(c[i]={...c[i],typedValue:r}),c});const d=g[i];if(d){const h=y.length;h<d.word.length&&d.word[h]===t.key?(p.increment(),m.playKeystroke()):(p.breakCombo(),m.playError())}}},[k,y,i,g,ge,p,m,j]),We=s.useCallback(t=>{t.preventDefault(),j.recordPasteAttempt()},[j]),pe=s.useCallback(async()=>{try{const a=await D.startGame({mode:"challenge",word_count:ke});Ne(a)}catch(a){console.error("Failed to start game session:",a)}const t=ve(ke);H.current=t.length,M(et(t)),ee(0),T(""),ae(0),se(0),ne(0),oe(0),le(100),te(N),p.reset(),V("ready")},[p]),he=s.useCallback(()=>{L.current=Date.now(),j.reset(),j.startTracking(),m.playGameStart(),V("playing"),A()},[m,A,j]),W=s.useCallback(async()=>{if(o)try{const t=await D.getDailyChallenges();_e(t.streak),de(t.challenges)}catch(t){console.error("Failed to refresh streak/challenges:",t)}},[o]),ye=s.useCallback(async()=>{if(R.current&&(clearInterval(R.current),R.current=null),j.stopTracking(),m.playGameEnd(),$)try{const t=g.filter(d=>d.status==="completed").map(d=>d.typedValue).join(" "),a=j.getAntiCheatData(),n={session_id:$.session_id,user_input:t,time_elapsed:N,checksum:$.checksum,max_combo:p.maxCombo,anti_cheat:{keystroke_timings:a.keystrokeTimings,keystroke_count:a.keystrokeCount,paste_attempts:a.pasteAttempts,focus_lost_count:a.focusLostCount,total_focus_lost_time:a.totalFocusLostTime,first_segment_avg:a.firstSegmentAvg,last_segment_avg:a.lastSegmentAvg}},r=await D.submitGameV2(n);(r.is_personal_best_wpm||r.is_personal_best_accuracy)&&(m.playPersonalBest(),me(!0),setTimeout(()=>me(!1),5e3)),Ce(r),f?.(r),W()}catch(t){console.error("Failed to submit results:",t)}V("game_complete")},[w,O,$,g,p.maxCombo,j,m,f,W]);s.useEffect(()=>{if(k==="playing")return R.current=setInterval(()=>{te(t=>t<=1?(ye(),0):t-1),ue()},1e3),()=>{R.current&&clearInterval(R.current)}},[k,ye,ue]),s.useEffect(()=>{k==="playing"&&(K(!0),A())},[k,A]),s.useEffect(()=>{o&&W()},[o,W]);const Ie=s.useCallback(async t=>{ce(t);try{(await D.claimChallengeReward(t)).success&&(de(n=>n.map(r=>r.challenge_id===t?{...r,is_claimed:!0}:r)),m.playChallengeComplete())}catch(a){console.error("Failed to claim challenge:",a)}finally{ce(null)}},[m]);if(k==="idle")return e.jsx("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"md:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-orange-500 to-red-600 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2 text-gray-900 dark:text-white",children:"Infinite Rush"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"60 seconds of pure typing adrenaline. How many words can you crush?"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Duration"})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"60 seconds"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Mode"})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Continuous word stream"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Goal"})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Max words + WPM"})]})]}),!o&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6 text-left",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm",children:"Playing as guest. Scores won't be saved."}),e.jsxs("button",{onClick:G,className:"mt-2 text-sm font-medium text-yellow-700 dark:text-yellow-300 hover:underline flex items-center gap-1",children:[e.jsx(Te,{className:"w-4 h-4"}),"Sign up to track progress"]})]})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:pe,className:"px-8 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg font-semibold text-lg hover:from-orange-600 hover:to-red-700 transition-all flex items-center gap-2 mx-auto",children:[e.jsx(Xe,{className:"w-5 h-5"}),"Start Rush"]})})]}),e.jsxs(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},className:"space-y-4",children:[o&&F&&e.jsx(fe,{streak:F,onUseFreeze:async()=>{try{await D.useStreakFreeze(),W()}catch(t){console.error("Failed to use freeze:",t)}}}),o&&ie.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-amber-500"}),"Daily Challenges"]}),e.jsx("div",{className:"space-y-3",children:ie.slice(0,2).map(t=>e.jsx(He,{challenge:t,onClaim:Ie,claiming:Re===t.challenge_id},t.challenge_id))})]}),!o&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 dark:from-gray-800 dark:to-gray-900 rounded-xl p-4 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Build your streak!"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Sign up to track your daily streak and compete on leaderboards."}),e.jsx("button",{onClick:G,className:"w-full py-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Get Started Free"})]})]})]})});if(k==="ready")return e.jsx("div",{className:"max-w-3xl mx-auto p-2 sm:p-4 md:p-6",children:e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8 text-center",children:[e.jsxs(l.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full mb-4 text-white font-bold text-lg bg-gradient-to-r from-orange-500 to-red-600",children:[e.jsx(Q,{className:"w-5 h-5"}),"Infinite Rush"]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-3 text-sm",children:["Type as many words as you can in 60 seconds!",e.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 text-orange-500 font-medium",children:[e.jsx(je,{className:"w-3.5 h-3.5"}),"60 seconds"]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-3 mb-5",children:e.jsxs("p",{className:"font-mono text-base sm:text-lg text-gray-600 dark:text-gray-400",children:[g.slice(0,6).map(t=>t.word).join(" "),"..."]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(tt,{onComplete:he,seconds:3}),e.jsx("button",{onClick:he,className:"px-6 py-2 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Start Now →"})]})]})});if(k==="playing")return e.jsx("div",{className:"max-w-3xl mx-auto p-2 sm:p-4 md:p-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-3 sm:p-4 md:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[u&&e.jsx("button",{onClick:u,className:"p-1.5 sm:p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Exit game",children:e.jsx(Ze,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsxs("div",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-orange-500"}),"Infinite Rush"]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"hidden xs:block",children:e.jsx(Oe,{settings:m.settings,onToggleSound:m.toggleSound,onVolumeChange:m.setVolume,compact:!0})}),e.jsxs(l.div,{className:`text-2xl sm:text-3xl md:text-4xl font-black tabular-nums ${v<=10?"text-red-500":"text-orange-500"}`,animate:v<=10?{scale:[1,1.1,1]}:{},transition:{duration:.5,repeat:v<=10?1/0:0},children:[v,"s"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1.5 sm:gap-2 md:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsx("div",{className:"text-base sm:text-lg md:text-2xl font-bold text-blue-600 dark:text-blue-400 tabular-nums",children:w}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"WPM"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsxs("div",{className:"text-base sm:text-lg md:text-2xl font-bold text-green-600 dark:text-green-400 tabular-nums",children:[O,"%"]}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"Acc"})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsx("div",{className:"text-base sm:text-lg md:text-2xl font-bold text-purple-600 dark:text-purple-400 tabular-nums",children:z}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"Words"})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-lg p-1.5 sm:p-2 md:p-3 text-center",children:[e.jsx(Le,{comboState:p.state,showMaxCombo:!1,size:"sm"}),!p.state.isActive&&e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600 dark:text-gray-400",children:"Combo"})]})]}),e.jsxs("div",{className:"relative w-full h-12 mb-3 sm:mb-4 bg-gradient-to-r from-indigo-100 via-purple-50 to-pink-100 dark:from-indigo-900/20 dark:via-purple-900/20 dark:to-pink-900/20 rounded-lg overflow-hidden",children:[[...Array(12)].map((t,a)=>e.jsx(l.div,{className:"absolute w-1 h-1 bg-yellow-300 dark:bg-yellow-400 rounded-full",style:{left:`${a*8+5}%`,top:`${20+a%3*25}%`},animate:{opacity:[.3,1,.3],scale:[.8,1.2,.8]},transition:{duration:1+a%3*.5,repeat:1/0,delay:a*.1}},a)),e.jsx(l.div,{className:"absolute bottom-0 left-0 h-1.5 bg-gradient-to-r from-orange-400 via-red-500 to-pink-500 rounded-full",style:{width:`${v/N*100}%`},transition:{duration:.1}}),e.jsx(l.div,{className:"absolute bottom-2",style:{left:`${Math.min((N-v)/N*95,95)}%`},animate:{y:[-2,2,-2],rotate:w>60?[-5,5,-5]:0},transition:{duration:.3,repeat:1/0},children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-8 h-5 bg-gradient-to-r from-red-500 to-orange-500 rounded-l-full rounded-r-lg relative",children:[e.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-cyan-300 rounded-full"}),e.jsx("div",{className:"absolute -bottom-1 left-1 w-3 h-2 bg-red-600 rounded-b-sm transform -rotate-12"}),e.jsx("div",{className:"absolute -top-1 left-1 w-3 h-2 bg-red-600 rounded-t-sm transform rotate-12"})]}),e.jsxs(l.div,{className:"absolute -left-4 top-1/2 -translate-y-1/2 flex gap-0.5",animate:{scaleX:[.8,1.2,.8]},transition:{duration:.15,repeat:1/0},children:[e.jsx("div",{className:"w-3 h-2 bg-gradient-to-l from-orange-400 to-yellow-300 rounded-l-full"}),e.jsx("div",{className:"w-2 h-1.5 bg-gradient-to-l from-yellow-300 to-transparent rounded-l-full mt-0.5"})]}),w>40&&e.jsx("div",{className:"absolute -left-6 top-1/2 -translate-y-1/2 flex flex-col gap-0.5",children:[...Array(3)].map((t,a)=>e.jsx(l.div,{className:"h-0.5 bg-orange-300 rounded-full",style:{width:`${6-a*1.5}px`,marginLeft:`${a*2}px`},animate:{opacity:[.3,.8,.3]},transition:{duration:.2,delay:a*.05,repeat:1/0}},a))})]})}),[10,20,30,40,50].map(t=>e.jsx("div",{className:`absolute bottom-2 text-[10px] font-bold ${z>=t?"text-green-500":"text-gray-400"}`,style:{left:`${t/60*90+5}%`},children:z>=t?"✓":t},t)),e.jsxs("div",{className:"absolute right-2 top-2 text-xs text-gray-400 font-mono",children:[Math.round(v/N*100),"%"]})]}),e.jsxs("div",{className:"relative",children:[!Se&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 z-10 flex items-center justify-center bg-gray-900/40 dark:bg-gray-900/60 backdrop-blur-[2px] rounded-xl cursor-pointer",onClick:A,children:e.jsx("div",{className:"text-white text-lg font-medium bg-gray-900/80 px-6 py-3 rounded-lg",children:"Click here to continue typing"})}),e.jsx(Ue,{words:g.slice(Math.max(0,i-2),i+10).map((t,a)=>({...t,index:a,status:t.index===g[i]?.index?"current":t.status})),currentWordIndex:Math.min(2,i),currentInput:y,getCharacterStates:t=>{const a=Math.max(0,i-2)+t;return q(a)},onContainerClick:A,className:"mb-2 sm:mb-3 md:mb-4"}),e.jsx("input",{ref:B,type:"text",inputMode:"text",enterKeyHint:"next",value:y,onKeyDown:X,onPaste:We,onChange:t=>{if(U.current){U.current=!1;return}const a=t.target.value,n=y;if(a.length>n.length){const r=a.slice(n.length);for(const d of r)X({key:d,preventDefault:()=>{}},!0)}else a.length<n.length&&X({key:"Backspace",preventDefault:()=>{}},!0)},onFocus:()=>K(!0),onBlur:()=>K(!1),className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-default",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-gramm":"false","aria-label":"Type the words shown above"})]}),e.jsxs("p",{className:"text-center text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-[10px] sm:text-xs",children:"Space"}),e.jsx("span",{className:"sm:hidden",children:" = next word"}),e.jsx("span",{className:"hidden sm:inline",children:" to move to next word"})]})]})});if(k==="game_complete"){const t=_?.is_personal_best_wpm||_?.is_personal_best_accuracy;return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 relative",children:[e.jsx($e,{children:Ae&&e.jsx("div",{className:"fixed inset-0 pointer-events-none z-50 overflow-hidden",children:[...Array(50)].map((a,n)=>e.jsx(l.div,{initial:{opacity:1,y:-20,x:Math.random()*(typeof window<"u"?window.innerWidth:1e3),rotate:0},animate:{opacity:0,y:(typeof window<"u"?window.innerHeight:800)+100,rotate:Math.random()*720-360},exit:{opacity:0},transition:{duration:2+Math.random()*2,delay:Math.random()*.5,ease:"easeOut"},className:`absolute w-3 h-3 ${["bg-yellow-400","bg-orange-500","bg-red-500","bg-pink-500"][Math.floor(Math.random()*4)]} ${Math.random()>.5?"rounded-full":"rounded-sm"}`},n))})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"md:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sm:p-8 text-center",children:[t?e.jsxs(l.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",damping:10},className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(l.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0},className:"w-24 h-24 bg-orange-400/30 rounded-full blur-xl"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"w-16 h-16 text-orange-500 mx-auto mb-2",fill:"currentColor"}),e.jsx(Qe,{className:"w-8 h-8 text-yellow-400 absolute -top-2 -right-2"})]})]}):e.jsx(ze,{className:"w-16 h-16 text-orange-500 mx-auto mb-4"}),e.jsx(l.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.15,type:"spring",damping:12},className:"mb-2",children:(()=>{const a=w>=80?"S":w>=60?"A":w>=45?"B":w>=30?"C":"D",n={S:"from-yellow-400 via-amber-500 to-orange-500",A:"from-green-400 to-emerald-500",B:"from-blue-400 to-cyan-500",C:"from-gray-400 to-gray-500",D:"from-red-400 to-red-500"},r={S:"Unstoppable!",A:"Speed Demon!",B:"Solid Rush!",C:"Keep Pushing!",D:"Warming Up!"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`inline-block text-5xl font-black bg-gradient-to-br ${n[a]} bg-clip-text text-transparent`,children:a}),e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:r[a]})]})})()}),e.jsx("h2",{className:"text-3xl font-bold mb-2 text-gray-900 dark:text-white",children:t?"New Personal Best!":"Rush Complete!"}),t&&e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex flex-wrap justify-center gap-2 mb-4",children:[_?.is_personal_best_wpm&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-gradient-to-r from-orange-400 to-red-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg",children:[e.jsx(Z,{className:"w-4 h-4"}),"Best WPM"]}),_?.is_personal_best_accuracy&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-gradient-to-r from-green-400 to-emerald-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg",children:[e.jsx(J,{className:"w-4 h-4"}),"Best Accuracy"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 my-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-4",children:[e.jsx(Ee,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:w}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"WPM"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-lg p-4",children:[e.jsx(J,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),e.jsxs("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[O,"%"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Accuracy"})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-4",children:[e.jsx(Fe,{className:"w-6 h-6 text-purple-500 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:z}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Words"})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-lg p-4",children:[e.jsx(Z,{className:"w-6 h-6 text-orange-500 mx-auto mb-2"}),e.jsxs("div",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:[p.maxCombo,"x"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Max Combo"})]})]}),_&&o&&e.jsxs(l.div,{initial:{scale:0,y:-30},animate:{scale:1,y:0},transition:{delay:.4,type:"spring",damping:8},className:"bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/30 dark:to-red-900/30 border border-orange-200 dark:border-orange-700 rounded-xl p-5 mb-6 relative overflow-hidden",children:[e.jsx(l.div,{animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 bg-gradient-to-r from-orange-400/10 via-red-400/20 to-orange-400/10"}),e.jsxs("div",{className:"relative",children:[e.jsxs(l.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6,type:"spring"},className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-600 to-red-600 dark:from-orange-400 dark:to-red-400",children:["+",_.xp_earned," XP"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Experience Earned"})]})]}),!o&&e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"text-xl font-bold text-orange-400/60 line-through mb-1",children:["+",Math.round(w*2.5)," XP"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sign up to earn XP and track your progress!"})]}),e.jsxs("button",{onClick:pe,className:"px-8 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg font-semibold text-lg hover:from-orange-600 hover:to-red-700 transition-all flex items-center gap-2 mx-auto",children:[e.jsx(Ye,{className:"w-5 h-5"}),"Play Again"]})]}),e.jsxs(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"space-y-4",children:[o&&F&&e.jsx(fe,{streak:F}),!o&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 dark:from-gray-800 dark:to-gray-900 rounded-xl p-4 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Track your progress!"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Sign up to build streaks, complete challenges, and climb the leaderboard."}),e.jsx("button",{onClick:G,className:"w-full py-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Create Free Account"})]})]})]}),e.jsx(be,{isOpen:b,onClose:C,onSkip:S,context:"game"})]})}return e.jsx(be,{isOpen:b,onClose:C,onSkip:S,context:"game"})},kt=()=>{const f=Be(),[u,o]=s.useState(!1),b=S=>{console.log("Infinite Rush completed:",S),o(!0)},C=()=>{f("/games/typing",{state:{gameCompleted:u}})};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-4 sm:py-8",children:e.jsx(at,{onComplete:b,onExit:C})})};export{kt as InfiniteRushPage,kt as default};
