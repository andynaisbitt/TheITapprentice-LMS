import{u as S,r as i,j as e,m as l,L as d,a as n,K as A,Z as P,b as T,C,S as L,Y as D,a1 as B,a2 as $,T as p,e as M,a3 as R}from"./index-smch1bU1.js";import{a as W}from"./tutorialApi-BGaAJxYc.js";import{p as y}from"./progressApi-BMQgYMb3.js";import{S as E,X as F,a as K,A as Q}from"./SkillsWidget-DQM48Lza.js";import{C as U}from"./clock-DNSf5APC.js";import{C as X}from"./calendar-D0h1sdek.js";import{P as q}from"./play-BSd53f-4.js";import{P as G}from"./pen-square-C1GUdoLG.js";import"./sparkles-BWRGzw9b.js";import"./flame-CrTy1GJj.js";import"./index-DCQZMRM7.js";import"./star-BX-qMkwk.js";import"./lock-BePiEsY1.js";import"./skillsApi-0HndmN36.js";const ne=()=>{const{user:a,logout:u}=S(),[o,b]=i.useState([]),[j,x]=i.useState(!0),[t,N]=i.useState(null),[c,f]=i.useState([]),[I,g]=i.useState(!0);i.useEffect(()=>{a&&k()},[a]);const k=async()=>{try{x(!0),g(!0);const[s,r,_]=await Promise.all([W(),y.getMyDashboard().catch(()=>null),y.getMyAchievements().catch(()=>[])]);b(s),N(r),f(_)}catch(s){console.error("Failed to load dashboard data:",s)}finally{x(!1),g(!1)}};if(!a)return null;const v=(()=>{const s=[];return s.push({icon:q,label:"Typing Game",href:"/games/typing",color:"from-blue-500 to-purple-600",description:"Practice typing"}),s.push({icon:n,label:"Tutorials",href:"/tutorials",color:"from-green-500 to-teal-600",description:"Learn new skills"}),s.push({icon:p,label:"Leaderboard",href:"/leaderboard",color:"from-yellow-500 to-orange-600",description:"See top learners"}),s.push({icon:R,label:"IT Skills",href:"/skills",color:"from-cyan-500 to-blue-600",description:"Track your skills"}),(a.role==="author"||a.can_write_blog||a.is_admin)&&s.push({icon:G,label:"Write Post",href:"/admin/blog",color:"from-pink-500 to-rose-600",description:"Create blog content"}),s})(),w=s=>{const r={admin:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",author:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",tutor:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",mentor:"bg-teal-100 text-teal-700 dark:bg-teal-900/30 dark:text-teal-400",contributor:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",supporter:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",apprentice:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"};return r[s]||r.apprentice},m=c.filter(s=>s.is_unlocked).slice(0,4),h=c.filter(s=>!s.is_unlocked&&s.progress>0).sort((s,r)=>r.progress_percent-s.progress_percent).slice(0,3);return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:["Welcome back, ",a.first_name,"! ðŸ‘‹"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Keep up the great work on your learning journey"})]}),e.jsx(E,{streak:t?.stats.current_streak||a.current_streak||0,compact:!0})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t?.stats.level_progress&&e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(F,{progress:t.stats.level_progress,showDetails:!0})}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:v.map((s,r)=>e.jsxs(d,{to:s.href,className:"group relative overflow-hidden bg-white dark:bg-gray-800 rounded-xl shadow hover:shadow-lg transition-all",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.color} opacity-0 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-2 rounded-xl bg-gradient-to-br ${s.color} flex items-center justify-center`,children:e.jsx(s.icon,{className:"w-6 h-6 text-white"})}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:s.label}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.description})]})]},r))})]}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(n,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tutorials"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?.stats.tutorials_completed||o.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"completed"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(A,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Games"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?.stats.typing_games_played||0}),e.jsx("div",{className:"text-xs text-gray-500",children:"played"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Best WPM"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?.stats.best_wpm?.toFixed(0)||"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:"words/min"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Accuracy"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[t?.stats.avg_accuracy?.toFixed(1)||"-","%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"average"})]})]}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-xl shadow",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5 text-blue-500"}),"Continue Learning"]}),e.jsxs(d,{to:"/tutorials",className:"text-blue-500 hover:text-blue-600 text-sm font-medium flex items-center gap-1",children:["View All ",e.jsx(C,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"p-4",children:j?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})}):o.filter(s=>s.status==="in_progress").length>0?e.jsx("div",{className:"space-y-3",children:o.filter(s=>s.status==="in_progress").slice(0,3).map(s=>e.jsxs(d,{to:`/tutorials/${s.tutorial_id}`,className:"block p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:["Tutorial #",s.tutorial_id]}),e.jsxs("span",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),s.time_spent_minutes," mins"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${s.progress_percentage||0}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:[s.progress_percentage||0,"%"]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(n,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:"Start a tutorial to begin learning!"}),e.jsxs(d,{to:"/tutorials",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition",children:[e.jsx(n,{className:"w-4 h-4"}),"Browse Tutorials"]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xl",children:[a.first_name[0],a.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[a.first_name," ",a.last_name,a.is_admin&&e.jsx(L,{className:"w-4 h-4 text-purple-500"})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["@",a.username]}),e.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 rounded-full text-xs font-medium ${w(a.role)}`,children:a.role.charAt(0).toUpperCase()+a.role.slice(1)})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:a.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsxs("span",{children:["Joined ",new Date(a.created_at||"").toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs(d,{to:"/profile",className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition text-sm",children:[e.jsx(B,{className:"w-4 h-4"}),"Profile"]}),e.jsx("button",{onClick:u,className:"flex items-center justify-center gap-2 px-3 py-2 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition text-sm",children:e.jsx($,{className:"w-4 h-4"})})]})]}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(K,{maxSkills:6,showLeaderboardLink:!0})}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-xl shadow",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-yellow-500"}),"Achievements"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[c.filter(s=>s.is_unlocked).length,"/",c.length]})]}),e.jsxs("div",{className:"p-4",children:[m.length>0?e.jsx("div",{className:"grid grid-cols-4 gap-2",children:m.map(s=>e.jsx(Q,{achievement:s,size:"sm",showProgress:!1},s.achievement_id))}):e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 text-sm py-4",children:"Complete activities to unlock achievements!"}),h.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"In Progress"}),h.map(s=>e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 truncate",children:s.name}),e.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 rounded-full mt-1",children:e.jsx("div",{className:"h-1 bg-blue-500 rounded-full",style:{width:`${s.progress_percent}%`}})})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.progress,"/",s.progress_max]})]},s.achievement_id))]})]})]}),t?.recent_activities&&t.recent_activities.length>0&&e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-xl shadow",children:[e.jsx("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700",children:e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-green-500"}),"Recent Activity"]})}),e.jsx("div",{className:"p-4 space-y-3",children:t.recent_activities.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 mt-2 rounded-full bg-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.title}),e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(s.created_at).toLocaleString(),s.xp_earned>0&&e.jsxs("span",{className:"ml-2 text-green-500",children:["+",s.xp_earned," XP"]})]})]})]},s.id))})]})]})]})]})})};export{ne as UserDashboard,ne as default};
