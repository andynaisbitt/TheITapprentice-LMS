import{c as A,o as I,f as $,u as D,r as i,j as e,m as n,U as q,a5 as R,q as U,a as b,Z as B,e as F,b as M}from"./index-smch1bU1.js";import{c}from"./coursesApi-BKihutzQ.js";import{R as O}from"./RegistrationPrompt-CfFLfNUY.js";import{u as T}from"./useRegistrationPrompt-CIWAgZXh.js";import{S as y}from"./star-BX-qMkwk.js";import{C as j}from"./clock-DNSf5APC.js";import{L as Y}from"./lock-BePiEsY1.js";import"./log-in-nT5SABG_.js";const f=A("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),ee=()=>{const{courseId:a}=I(),l=$(),{isAuthenticated:Z}=D(),[s,N]=i.useState(null),[d,o]=i.useState(!1),[v,x]=i.useState(!0),[m,u]=i.useState(null),[p,g]=i.useState(!1),{isPromptOpen:w,closePrompt:k,handleSkip:C,checkAuthAndProceed:h}=T({context:"course",onSkip:()=>{l(`/courses/${a}/learn`)}});i.useEffect(()=>{(async()=>{if(a)try{x(!0),u(null);const t=await c.getCourse(a);N(t);try{const S=(await c.getMyCourses()).some(P=>P.id===a);o(S)}catch{console.log("User not authenticated")}}catch(t){console.error("Error fetching course:",t),u("Failed to load course. Please try again later.")}finally{x(!1)}})()},[a]);const _=async()=>{if(a&&h())try{g(!0),await c.enrollInCourse({course_id:a}),o(!0),l(`/courses/${a}/learn`)}catch(r){if(console.error("Error enrolling:",r),r.response?.status===401)h();else if(r.response?.status===400&&r.response?.data?.detail?.includes("Already enrolled"))o(!0),l(`/courses/${a}/learn`);else{const t=r.response?.data?.detail||"Failed to enroll. Please try again.";alert(t)}}finally{g(!1)}},E=()=>{if(!s)return"";switch(s.level){case"beginner":return"bg-green-500/20 text-green-400 border-green-500/30";case"intermediate":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"advanced":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},z=()=>{if(!s)return e.jsx(b,{size:16});switch(s.level){case"beginner":return e.jsx(M,{size:16});case"intermediate":return e.jsx(F,{size:16});case"advanced":return e.jsx(B,{size:16});default:return e.jsx(b,{size:16})}};return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900/10 to-purple-900/10 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading course..."})]})}):m||!s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900/10 to-purple-900/10 flex items-center justify-center",children:e.jsx("div",{className:"text-center max-w-md",children:e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-2xl p-8",children:[e.jsx("p",{className:"text-red-400 mb-4",children:m||"Course not found"}),e.jsx("button",{onClick:()=>l("/courses"),className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:"Back to Courses"})]})})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900/10 to-purple-900/10",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[e.jsx("button",{onClick:()=>l("/courses"),className:"mb-6 text-gray-400 hover:text-white transition-colors flex items-center gap-2",children:"← Back to Courses"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-800/50 backdrop-blur rounded-2xl p-8 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium border flex items-center gap-2 ${E()}`,children:[z(),s.level]}),s.is_premium&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-500/20 text-yellow-400 border border-yellow-500/30 flex items-center gap-1",children:[e.jsx(y,{size:14}),"Premium"]}),s.is_featured&&e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-purple-500/20 text-purple-400 border border-purple-500/30",children:"Featured"})]}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:s.title}),e.jsx("p",{className:"text-xl text-gray-300 mb-6",children:s.short_description||s.description}),e.jsxs("div",{className:"flex flex-wrap gap-6 text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{size:18,className:"text-blue-400"}),e.jsxs("span",{children:[s.estimated_hours," hours"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:18,className:"text-purple-400"}),e.jsxs("span",{children:[s.enrollment_count," enrolled"]})]}),s.difficulty_rating>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{size:18,className:"text-yellow-400 fill-yellow-400"}),e.jsxs("span",{children:[s.difficulty_rating,"/5"]})]}),s.completion_count>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:18,className:"text-green-400"}),e.jsxs("span",{children:[s.completion_count," completed"]})]})]})]}),e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gray-800/50 backdrop-blur rounded-2xl p-8 border border-gray-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"About This Course"}),e.jsx("p",{className:"text-gray-300 leading-relaxed whitespace-pre-line",children:s.description})]}),s.objectives&&s.objectives.length>0&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gray-800/50 backdrop-blur rounded-2xl p-8 border border-gray-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"What You'll Learn"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.objectives.map((r,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(U,{size:18,className:"text-green-400 flex-shrink-0 mt-1"}),e.jsx("span",{className:"text-gray-300",children:r})]},t))})]}),s.modules&&s.modules.length>0&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gray-800/50 backdrop-blur rounded-2xl p-8 border border-gray-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Course Content"}),e.jsx("div",{className:"space-y-3",children:s.modules.sort((r,t)=>r.order_index-t.order_index).map((r,t)=>e.jsx("div",{className:"bg-gray-700/30 rounded-xl p-4 border border-gray-600/50 hover:border-blue-500/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:"text-blue-400 font-semibold",children:["Module ",t+1]}),r.duration&&e.jsxs("span",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(j,{size:14}),r.duration]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:r.title}),r.description&&e.jsx("p",{className:"text-gray-400 text-sm",children:r.description}),r.sections&&r.sections.length>0&&e.jsxs("div",{className:"mt-3 text-sm text-gray-400",children:[r.sections.length," sections"]})]}),!d&&r.status==="locked"&&e.jsx(Y,{size:20,className:"text-gray-500"})]})},r.id))})]}),s.requirements&&s.requirements.length>0&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-gray-800/50 backdrop-blur rounded-2xl p-8 border border-gray-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Requirements"}),e.jsx("ul",{className:"space-y-2",children:s.requirements.map((r,t)=>e.jsxs("li",{className:"flex items-start gap-2 text-gray-300",children:[e.jsx("span",{className:"text-blue-400",children:"•"}),e.jsx("span",{children:r})]},t))})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-gray-800/50 backdrop-blur rounded-2xl p-6 border border-gray-700/50 sticky top-6",children:[s.image&&e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-48 object-cover rounded-xl mb-6"}),d?e.jsxs("button",{onClick:()=>l(`/courses/${a}/learn`),className:`w-full px-6 py-4 bg-gradient-to-r from-green-500 to-emerald-500\r
                           text-white font-bold rounded-xl hover:from-green-600 hover:to-emerald-600\r
                           transition-all flex items-center justify-center gap-2 mb-4`,children:[e.jsx(f,{size:20}),"Continue Learning"]}):e.jsxs("button",{onClick:_,disabled:p,className:`w-full px-6 py-4 bg-gradient-to-r from-blue-500 to-purple-500\r
                           text-white font-bold rounded-xl hover:from-blue-600 hover:to-purple-600\r
                           transition-all flex items-center justify-center gap-2 mb-4 disabled:opacity-50`,children:[e.jsx(f,{size:20}),p?"Enrolling...":s.is_premium?`Enroll for $${s.price}`:"Enroll Now"]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[s.instructor_name&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 mb-1",children:"Instructor"}),e.jsx("div",{className:"text-white font-medium",children:s.instructor_name})]}),s.category&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 mb-1",children:"Category"}),e.jsx("div",{className:"text-white font-medium",children:s.category})]}),s.published_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 mb-1",children:"Published"}),e.jsx("div",{className:"text-white font-medium",children:new Date(s.published_at).toLocaleDateString()})]}),s.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 mb-1",children:"Last Updated"}),e.jsx("div",{className:"text-white font-medium",children:new Date(s.updated_at).toLocaleDateString()})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-gray-400 mb-3",children:"Skills You'll Gain"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills.map((r,t)=>e.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-400 text-xs rounded-lg border border-blue-500/20",children:r},t))})]})]})})]})]}),e.jsx(O,{isOpen:w,onClose:k,onSkip:C,context:"course"})]})};export{ee as default};
