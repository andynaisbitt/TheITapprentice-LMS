import{c as j,r as l,j as e,x as A,U as m,e as h,N as b,h as p,a as T,ad as U,G as M,K as E,Z as P,L as u}from"./index-CH_EXTVi.js";import{a as y}from"./admin-stats.api-sP13XqpO.js";import{L as G}from"./loader-2-DMEWPFv_.js";import{E as F}from"./eye-1AaRE1SP.js";import{R as B}from"./refresh-cw-CMpTE3pz.js";const k=j("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),n=j("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),V=()=>{const[v,w]=l.useState("30d"),[r,N]=l.useState(null),[I,f]=l.useState(null),[_,o]=l.useState(!0),[c,g]=l.useState(null),i=async()=>{o(!0),g(null);try{const[a,s]=await Promise.all([y.getDashboard(),y.getContentStats()]);N(a),f(s)}catch(a){console.error("Failed to load analytics:",a),g(a.response?.data?.detail||"Failed to load analytics data")}finally{o(!1)}};if(l.useEffect(()=>{i()},[]),_)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{className:"w-8 h-8 animate-spin text-primary"})});if(c)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-red-600"}),e.jsx("p",{className:"text-red-800 dark:text-red-200",children:c})]}),e.jsx("button",{onClick:i,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]})});const t=r?.stats,S=[{label:"Total Views",value:t?.total_views?.toLocaleString()||"0",icon:F,color:"blue",link:"/admin/posts"},{label:"Total Users",value:t?.total_users?.toLocaleString()||"0",icon:m,color:"green",link:"/admin/users"},{label:"Active Users",value:t?.active_users?.toLocaleString()||"0",icon:m,color:"emerald",link:"/admin/users"},{label:"New Users (30d)",value:t?.new_users_this_month?.toLocaleString()||"0",change:r?.trends?.find(a=>a.label==="New Users")?.change,icon:h,color:"purple"}],L=[{label:"Total Posts",value:t?.total_posts||0,icon:b,color:"blue",link:"/admin/posts"},{label:"Draft Posts",value:t?.draft_posts||0,icon:b,color:"orange",link:"/admin/posts?status=draft"},{label:"Categories",value:t?.total_categories||0,icon:p,color:"indigo",link:"/admin/categories"},{label:"Tags",value:t?.total_tags||0,icon:p,color:"pink",link:"/admin/tags"}],C=[{label:"Tutorials",value:`${t?.tutorials_published||0} / ${t?.total_tutorials||0}`,icon:T,color:"purple",link:"/admin/tutorials"},{label:"Courses",value:`${t?.courses_published||0} / ${t?.total_courses||0}`,icon:U,color:"green",link:"/admin/courses"},{label:"Enrollments",value:t?.total_enrollments?.toLocaleString()||"0",icon:M,color:"blue",link:"/admin/courses/enrollments"},{label:"Games Played",value:t?.typing_games_played?.toLocaleString()||"0",icon:E,color:"orange",link:"/admin/games/leaderboard"}],$=[{label:"Total XP Awarded",value:t?.total_xp_awarded?.toLocaleString()||"0",icon:P,color:"yellow",link:"/admin/xp-config"}],D=a=>{const s={blue:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",green:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",emerald:"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400",purple:"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400",orange:"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400",indigo:"bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400",pink:"bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400",yellow:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400"};return s[a]||s.blue},d=(a,s)=>{const R=a.icon,x=e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`p-3 rounded-lg ${D(a.color)}`,children:e.jsx(R,{className:"w-5 h-5"})}),a.change!==void 0&&a.change!==null&&e.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${a.change>=0?"text-green-600":"text-red-600"}`,children:[a.change>=0?e.jsx(n,{className:"w-4 h-4"}):e.jsx(k,{className:"w-4 h-4"}),Math.abs(a.change),"%"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.label})]})]},`${a.label}-${s}`);return a.link?e.jsx(u,{to:a.link,className:"block",children:x},`${a.label}-${s}`):x};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Analytics"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Real-time overview of your site's performance"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:i,className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Refresh",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 rounded-lg p-1",children:["7d","30d","90d"].map(a=>e.jsx("button",{onClick:()=>w(a),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${v===a?"bg-primary text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:a==="7d"?"7 Days":a==="30d"?"30 Days":"90 Days"},a))})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Overview"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:S.map((a,s)=>d(a,s))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Content"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:L.map((a,s)=>d(a,s))})]}),t?.total_tutorials||t?.total_courses||t?.typing_games_played?e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Learning Management (LMS)"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:C.map((a,s)=>d(a,s))})]}):null,t?.total_xp_awarded?e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Gamification"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:$.map((a,s)=>d(a,s))})]}):null,r?.trends&&r.trends.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Trends"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.trends.map((a,s)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:e.jsx(h,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.label}),a.change!==void 0&&e.jsxs("p",{className:`text-xs flex items-center gap-1 mt-1 ${a.change>=0?"text-green-600":"text-red-600"}`,children:[a.change>=0?e.jsx(n,{className:"w-3 h-3"}):e.jsx(k,{className:"w-3 h-3"}),Math.abs(a.change),"% ",a.change_label]})]})]},s))})]}),r?.system_status&&r.system_status.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"System Status"}),e.jsx("div",{className:"space-y-3",children:r.system_status.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${a.status==="healthy"?"bg-green-500":a.status==="warning"?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.name})]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.message||a.status})]},a.id))})]}),r?.attention_items&&r.attention_items.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Needs Attention"}),e.jsx("div",{className:"space-y-3",children:r.attention_items.map(a=>e.jsxs(u,{to:a.link,className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${a.priority==="high"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":a.priority==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:a.count}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.description})]})]}),e.jsx(n,{className:"w-5 h-5 text-gray-400"})]},a.id))})]}),r?.last_updated&&e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center",children:["Last updated: ",new Date(r.last_updated).toLocaleString()]})]})};export{V as AnalyticsPage,V as default};
