import{c as S,r as a,s as _,j as e,U as E,e as L,G as p,l as A}from"./index-CH_EXTVi.js";import{L as T}from"./loader-2-DMEWPFv_.js";const U=S("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),M=()=>{const[l,o]=a.useState([]),[h,g]=a.useState([]),[y,m]=a.useState(!0),[i,f]=a.useState(""),[c,j]=a.useState("all"),[n,N]=a.useState("all");a.useEffect(()=>{b()},[]);const b=async()=>{m(!0);try{const r=(await _.get("/courses/admin/enrollments")).data,d=(r.enrollments||[]).map(s=>({id:s.id,user:s.user||{id:0,username:"Unknown",email:""},course:s.course||{id:"",title:"Unknown Course",level:"beginner"},enrolled_at:s.enrolled_at||new Date().toISOString(),progress_percent:s.progress_percent||0,last_activity:s.last_activity,status:s.status||"active"}));o(d),g(r.course_stats||[])}catch(t){console.error("Failed to load enrollments:",t),o([]),g([])}finally{m(!1)}},v=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),k=t=>{if(!t)return"Never";const r=new Date(t),s=Math.floor((new Date().getTime()-r.getTime())/(1e3*60));return s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:`${Math.floor(s/1440)}d ago`},w=t=>{switch(t){case"active":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";case"paused":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"}},C=[...new Set(l.map(t=>t.course.id))].map(t=>{const r=l.find(d=>d.course.id===t);return{id:t,title:r?.course.title||t}}),u=l.filter(t=>{if(c!=="all"&&t.course.id!==c||n!=="all"&&t.status!==n)return!1;if(i){const r=i.toLowerCase();if(!t.user.username.toLowerCase().includes(r)&&!t.user.email.toLowerCase().includes(r)&&!t.course.title.toLowerCase().includes(r))return!1}return!0}),x={enrollments:l.length,active:l.filter(t=>t.status==="active").length,completed:l.filter(t=>t.status==="completed").length};return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Course Enrollments"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"View and manage student enrollments across all courses"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(E,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x.enrollments}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Enrollments"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(L,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x.active}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active Students"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(p,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x.completed}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Completions"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Course Performance"}),e.jsx("div",{className:"space-y-4",children:h.map(t=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.course_title}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[t.total_enrollments," enrolled"]}),e.jsxs("span",{children:[t.active_students," active"]})]})]}),e.jsxs("div",{className:"w-32",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Completion"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[t.completion_rate,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${t.completion_rate}%`}})})]})]},t.course_id))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by student or course...",value:i,onChange:t=>f(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("select",{value:c,onChange:t=>j(t.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Courses"}),C.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]}),e.jsxs("select",{value:n,onChange:t=>N(t.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"paused",children:"Paused"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Course"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Enrolled"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Last Activity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 w-10"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary to-primary-dark flex items-center justify-center text-white text-sm font-semibold",children:t.user.username[0].toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.user.username}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.user.email})]})]})}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.course.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:t.course.level})]}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400",children:v(t.enrolled_at)}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${t.progress_percent===100?"bg-green-500":"bg-primary"}`,style:{width:`${t.progress_percent}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.progress_percent,"%"]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400",children:k(t.last_activity)}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:e.jsx(U,{className:"w-4 h-4"})})})]},t.id))})]})}),u.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No enrollments found"})]})]})]})};export{M as CourseEnrollmentsAdmin,M as default};
