import{r as l,s as c,j as e,w as A,a4 as F,U as D,Z as L,b as R,l as E,T as M,a3 as W}from"./index-CH_EXTVi.js";import{L as G}from"./loader-2-DMEWPFv_.js";import{R as X}from"./refresh-cw-CMpTE3pz.js";import{P as I}from"./pen-DH6aCffj.js";import{T as $}from"./trash-2-CEmDLHiu.js";const q=()=>{const[d,i]=l.useState([]),[x,f]=l.useState(null),[j,y]=l.useState(!0),[p,k]=l.useState(""),[m,w]=l.useState("all"),[v,g]=l.useState(!1),[n,o]=l.useState(null),[a,s]=l.useState({title:"",description:"",challenge_type:"typing_game",difficulty:"medium",target_count:3,base_xp_reward:100,icon:"keyboard",is_active:!0});l.useEffect(()=>{h()},[]);const h=async()=>{y(!0);try{const t=await c.get("/typing-game/admin/analytics");f(t.data);const P=((await c.get("/shared/admin/challenges/templates?include_inactive=true")).data||[]).filter(b=>b.challenge_type==="typing_game"||b.challenge_type==="typing_wpm");i(P)}catch(t){console.error("Failed to load data:",t),i([])}finally{y(!1)}},N=t=>{o(t),s({title:t.title,description:t.description||"",challenge_type:t.challenge_type,difficulty:t.difficulty,target_count:t.target_count,base_xp_reward:t.base_xp_reward,icon:t.icon||"keyboard",is_active:t.is_active}),g(!0)},_=async t=>{if(confirm("Are you sure you want to delete this challenge template?"))try{await c.delete(`/shared/admin/challenges/templates/${t}`),i(d.filter(r=>r.id!==t))}catch(r){console.error("Failed to delete:",r),alert("Failed to delete challenge template")}},C=async()=>{try{if(n){const t=await c.put(`/shared/admin/challenges/templates/${n.id}`,a);i(d.map(r=>r.id===n.id?t.data:r))}else{const t=await c.post("/shared/admin/challenges/templates",a);i([...d,t.data])}g(!1),o(null)}catch(t){console.error("Failed to save:",t),alert("Failed to save challenge template")}},T=t=>{switch(t){case"easy":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";case"hard":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"}},S=t=>{switch(t){case"typing_game":return"Play Games";case"typing_wpm":return"Achieve WPM";default:return t}},u=d.filter(t=>{if(m!=="all"&&t.challenge_type!==m)return!1;if(p){const r=p.toLowerCase();if(!t.title.toLowerCase().includes(r)&&!(t.description||"").toLowerCase().includes(r))return!1}return!0});return j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Typing Challenges"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Create and manage typing challenge templates for daily challenges"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:h,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Refresh",children:e.jsx(X,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:()=>{o(null),s({title:"",description:"",challenge_type:"typing_game",difficulty:"medium",target_count:3,base_xp_reward:100,icon:"keyboard",is_active:!0}),g(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),"New Challenge"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(F,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x?.total_games_played?.toLocaleString()||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Games Played"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(D,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x?.total_players?.toLocaleString()||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Players"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(L,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[x?.average_wpm?.toFixed(0)||0," WPM"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Avg Speed"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:e.jsx(R,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[x?.average_accuracy?.toFixed(1)||0,"%"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Avg Accuracy"})]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Challenge Templates:"})," These templates are used to generate daily typing challenges. Active templates are randomly selected each day to create challenges for users."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search challenge templates...",value:p,onChange:t=>k(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("select",{value:m,onChange:t=>w(t.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"typing_game",children:"Play Games"}),e.jsx("option",{value:"typing_wpm",children:"Achieve WPM"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Challenge Template"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Difficulty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Target"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"XP Reward"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 w-20"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:t.description||"No description"})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",children:S(t.challenge_type)})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full capitalize ${T(t.difficulty)}`,children:t.difficulty})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-600 dark:text-gray-300",children:t.challenge_type==="typing_wpm"?e.jsxs("span",{children:[t.target_count," WPM"]}):e.jsxs("span",{children:[t.target_count," games"]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"text-sm font-medium text-primary flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4"}),"+",t.base_xp_reward," XP"]})}),e.jsx("td",{className:"px-4 py-4",children:t.is_active?e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:"Active"}):e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 dark:bg-gray-700 text-gray-500",children:"Inactive"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>N(t),className:"p-2 text-gray-400 hover:text-primary transition-colors",title:"Edit",children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(t.id),className:"p-2 text-gray-400 hover:text-red-500 transition-colors",title:"Delete",children:e.jsx($,{className:"w-4 h-4"})})]})})]},t.id))})]})}),u.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:d.length===0?"No typing challenge templates yet. Create one to get started!":"No challenges match your filters"})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n?"Edit Challenge Template":"Create New Challenge Template"})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:a.title,onChange:t=>s({...a,title:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Speed Demon"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:t=>s({...a,description:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Brief description of the challenge",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Challenge Type"}),e.jsxs("select",{value:a.challenge_type,onChange:t=>s({...a,challenge_type:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"typing_game",children:"Play X Games"}),e.jsx("option",{value:"typing_wpm",children:"Achieve X WPM"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Difficulty"}),e.jsxs("select",{value:a.difficulty,onChange:t=>s({...a,difficulty:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Target ",a.challenge_type==="typing_wpm"?"(WPM)":"(Games)"]}),e.jsx("input",{type:"number",value:a.target_count,onChange:t=>s({...a,target_count:parseInt(t.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:1}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.challenge_type==="typing_wpm"?"WPM to achieve in a single game":"Number of games to complete"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"XP Reward"}),e.jsx("input",{type:"number",value:a.base_xp_reward,onChange:t=>s({...a,base_xp_reward:parseInt(t.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:0,step:10})]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.is_active,onChange:t=>s({...a,is_active:t.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Active (will be included in daily challenge generation)"})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{g(!1),o(null)},className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!a.title,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:opacity-50",children:n?"Save Changes":"Create Template"})]})]})})]})};export{q as TypingChallengesAdmin,q as default};
