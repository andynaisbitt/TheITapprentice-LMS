import{r as m,j as e,m as o,g as h,y as _,i as $,Z as R,b as v,K as A,e as D,a5 as F}from"./index-smch1bU1.js";import{S as L}from"./StreakDisplay-Bpxu2VQR.js";import{D as P}from"./DailyChallengeCard-D25bM2_q.js";import{R as w}from"./refresh-cw-D6f53Yxm.js";import{C as S}from"./clock-DNSf5APC.js";import{L as T}from"./lightbulb-BmlqlY_f.js";import"./flame-CrTy1GJj.js";import"./gift-ru-Puqui.js";import"./loader-2-D9MIupjh.js";const z=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]];function b(s){return s===null?"bg-gray-200 dark:bg-gray-700":s>=95?"bg-green-400 dark:bg-green-600":s>=85?"bg-green-300 dark:bg-green-700":s>=75?"bg-yellow-300 dark:bg-yellow-600":s>=60?"bg-orange-300 dark:bg-orange-600":"bg-red-400 dark:bg-red-600"}function j(s){return s===null?"text-gray-500 dark:text-gray-400":s>=95?"text-green-900 dark:text-green-100":s>=85?"text-green-800 dark:text-green-100":s>=75?"text-yellow-900 dark:text-yellow-100":s>=60?"text-orange-900 dark:text-orange-100":"text-red-900 dark:text-red-100"}function E({letterStats:s,showAllKeys:g=!0}){const i=m.useMemo(()=>{const a=new Map;return s.forEach(r=>{a.set(r.character.toLowerCase(),r)}),a},[s]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Keyboard Accuracy Heatmap"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-red-400 dark:bg-red-600"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"<60%"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-orange-300 dark:bg-orange-600"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"60-75%"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-yellow-300 dark:bg-yellow-600"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"75-85%"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-green-300 dark:bg-green-700"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"85-95%"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-green-400 dark:bg-green-600"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:">95%"})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[z.map((a,r)=>e.jsx("div",{className:"flex gap-1",style:{marginLeft:r===1?"20px":r===2?"40px":"0"},children:a.map((l,u)=>{const y=i.get(l),d=y?.accuracy??null,p=y?.attempts??0,c=y!==void 0&&p>0;return e.jsxs(o.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:(r*10+u)*.02},whileHover:{scale:1.1,zIndex:10},className:`
                    relative w-10 h-10 sm:w-12 sm:h-12 rounded-lg
                    flex items-center justify-center
                    font-semibold uppercase text-lg
                    cursor-pointer transition-shadow
                    hover:shadow-lg
                    ${g||c?b(d):"bg-gray-100 dark:bg-gray-800"}
                    ${g||c?j(d):"text-gray-400 dark:text-gray-600"}
                  `,title:c?`${l.toUpperCase()}: ${d?.toFixed(1)}% accuracy (${p} attempts)`:`${l.toUpperCase()}: No data`,children:[l,c&&d!==null&&d<75&&e.jsx(o.div,{animate:{scale:[1,1.2,1]},transition:{duration:1,repeat:1/0},className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"})]},l)})},r)),e.jsx("div",{className:"mt-2",children:(()=>{const a=i.get(" "),r=a?.accuracy??null,l=a!==void 0&&a.attempts>0;return e.jsx(o.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.02},className:`
                  w-48 h-10 rounded-lg
                  flex items-center justify-center
                  text-sm font-medium
                  ${g||l?b(r):"bg-gray-100 dark:bg-gray-800"}
                  ${g||l?j(r):"text-gray-400 dark:text-gray-600"}
                `,title:l?`Space: ${r?.toFixed(1)}% accuracy`:"Space: No data",children:"space"})})()})]}),s.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Keys Needing Practice"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.filter(a=>a.accuracy<85&&a.attempts>=10).sort((a,r)=>a.accuracy-r.accuracy).slice(0,5).map(a=>e.jsxs("div",{className:`px-3 py-1.5 rounded-lg ${b(a.accuracy)} ${j(a.accuracy)} text-sm font-medium`,children:[a.character===" "?"space":a.character.toUpperCase(),": ",a.accuracy.toFixed(0),"%"]},a.character)),s.filter(a=>a.accuracy<85&&a.attempts>=10).length===0&&e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Great job! All your frequently used keys are above 85% accuracy."})]})]})]})}function Z(){const[s,g]=m.useState(null),[i,a]=m.useState(null),[r,l]=m.useState(!0),[u,y]=m.useState(null),[d,p]=m.useState(null);m.useEffect(()=>{c()},[]);const c=async()=>{l(!0),p(null);try{const[t,n]=await Promise.all([h.get("/api/v1/games/typing/analytics/me"),h.get("/api/v1/games/typing/challenges/daily")]);g(t.data),a(n.data)}catch(t){p(t.response?.data?.detail||"Failed to load analytics")}finally{l(!1)}},k=async t=>{y(t);try{await h.post(`/api/v1/games/typing/challenges/${t}/claim`);const n=await h.get("/api/v1/games/typing/challenges/daily");a(n.data)}catch(n){console.error("Failed to claim reward:",n)}finally{y(null)}},C=async()=>{try{await h.post("/api/v1/games/typing/streak/freeze");const t=await h.get("/api/v1/games/typing/challenges/daily");a(t.data)}catch(t){console.error("Failed to use freeze:",t)}};if(r)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading your analytics..."})]})});if(d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4",children:d}),e.jsxs("button",{onClick:c,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center gap-2 mx-auto",children:[e.jsx(w,{className:"w-4 h-4"}),"Retry"]})]})});const x=s?.typing_stats,N=s?.letter_analysis,f=s?.recommendations||[];return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4 md:p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx($,{className:"w-7 h-7 text-blue-500"}),"Typing Analytics"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Track your progress and improve your typing skills"})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Refresh data",children:e.jsx(w,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[e.jsx(R,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("div",{className:"text-2xl font-bold",children:x?.best_wpm||0}),e.jsx("div",{className:"text-sm opacity-80",children:"Best WPM"})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-4 text-white",children:[e.jsx(v,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsxs("div",{className:"text-2xl font-bold",children:[x?.best_accuracy?.toFixed(1)||0,"%"]}),e.jsx("div",{className:"text-sm opacity-80",children:"Best Accuracy"})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:[e.jsx(A,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("div",{className:"text-2xl font-bold",children:x?.total_games||0}),e.jsx("div",{className:"text-sm opacity-80",children:"Games Played"})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl p-4 text-white",children:[e.jsx(S,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("div",{className:"text-2xl font-bold",children:x?.total_time_minutes||0}),e.jsx("div",{className:"text-sm opacity-80",children:"Minutes Practiced"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 text-sm mb-1",children:[e.jsx(D,{className:"w-4 h-4"}),"Average WPM"]}),e.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:x?.avg_wpm?.toFixed(1)||0})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 text-sm mb-1",children:[e.jsx(v,{className:"w-4 h-4"}),"Average Accuracy"]}),e.jsxs("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[x?.avg_accuracy?.toFixed(1)||0,"%"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 text-sm mb-1",children:[e.jsx(F,{className:"w-4 h-4"}),"Words Typed"]}),e.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:(x?.total_words_typed||0).toLocaleString()})]})]}),N&&e.jsx(E,{letterStats:N.letter_heatmap}),f.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-yellow-500"}),"Practice Recommendations"]}),e.jsx("div",{className:"space-y-3",children:f.map((t,n)=>e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.1},className:`p-3 rounded-lg border ${t.priority==="high"?"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800":"bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded-full ${t.priority==="high"?"bg-red-200 text-red-700 dark:bg-red-800 dark:text-red-200":"bg-yellow-200 text-yellow-700 dark:bg-yellow-800 dark:text-yellow-200"}`,children:t.priority}),e.jsxs("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:[t.type==="letter"?"Letter":"Pattern",": ",e.jsx("strong",{children:t.target})]})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[t.accuracy,"% accuracy"]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.suggestion})]},n))})]})]}),e.jsxs("div",{className:"space-y-6",children:[i?.streak&&e.jsx(L,{streak:i.streak,onUseFreeze:C}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Daily Challenges"}),e.jsxs("div",{className:"space-y-4",children:[i?.challenges.map(t=>e.jsx(P,{challenge:t,onClaim:k,claiming:u===t.challenge_id},t.challenge_id)),(!i?.challenges||i.challenges.length===0)&&e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No challenges available today. Check back tomorrow!"})]})]})]})]})]})})}export{Z as TypingAnalyticsDashboard,Z as default};
