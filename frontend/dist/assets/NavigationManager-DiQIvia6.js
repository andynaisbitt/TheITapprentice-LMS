import{s as c,f as q,Q as U,r as d,j as e}from"./index-CH_EXTVi.js";const x={getAll:async()=>(await c.get("/api/v1/admin/navigation")).data,getById:async s=>(await c.get(`/api/v1/admin/navigation/${s}`)).data,create:async s=>(await c.post("/api/v1/admin/navigation",s)).data,update:async(s,u)=>(await c.put(`/api/v1/admin/navigation/${s}`,u)).data,delete:async s=>{await c.delete(`/api/v1/admin/navigation/${s}`)},reorder:async s=>{await c.post("/api/v1/admin/navigation/reorder",s)}},$=[{id:"tutorials",label:"Tutorials",url:"/tutorials",icon:"ðŸ“š",plugin:"tutorials"},{id:"courses",label:"Courses",url:"/courses",icon:"ðŸŽ“",plugin:"courses"},{id:"games",label:"Practice",url:"/games/typing",icon:"âŒ¨ï¸",plugin:"typing_game",altLabels:["Games","Practice","Typing Practice"]},{id:"quizzes",label:"Quizzes",url:"/quizzes",icon:"â“",plugin:"quizzes"}],O=()=>{const s=q(),{isPluginEnabled:u}=U(),[l,j]=d.useState([]),[A,N]=d.useState(!0),[v,w]=d.useState(null),[i,m]=d.useState(null),[I,p]=d.useState(!1),[H,M]=d.useState(!1),[_,b]=d.useState(""),[E,y]=d.useState(null),[r,n]=d.useState({label:"",url:"",order:0,visible:!0,show_in_header:!0,show_in_footer:!1,target_blank:!1});d.useEffect(()=>{g()},[]);const g=async()=>{try{N(!0);const t=await x.getAll();j(t),w(null)}catch(t){w(t.response?.data?.detail||"Failed to load navigation items")}finally{N(!1)}},L=async t=>{t.preventDefault();try{await x.create(r),p(!1),k(),g()}catch(a){alert(a.response?.data?.detail||"Failed to create menu item")}},P=async t=>{if(t.preventDefault(),!!i)try{await x.update(i.id,r),m(null),k(),g()}catch(a){alert(a.response?.data?.detail||"Failed to update menu item")}},z=async t=>{if(confirm("Are you sure you want to delete this menu item?"))try{await x.delete(t),g()}catch(a){alert(a.response?.data?.detail||"Failed to delete menu item")}},F=t=>{if(t===0)return;const a=[...l];[a[t],a[t-1]]=[a[t-1],a[t]],C(a)},D=t=>{if(t===l.length-1)return;const a=[...l];[a[t],a[t+1]]=[a[t+1],a[t]],C(a)},C=async t=>{const a=t.map((o,h)=>({id:o.id,order:h}));try{await x.reorder(a),j(t)}catch{alert("Failed to reorder items")}},T=t=>{m(t),n({label:t.label,url:t.url,order:t.order,parent_id:t.parent_id,visible:t.visible,show_in_header:t.show_in_header,show_in_footer:t.show_in_footer,target_blank:t.target_blank})},k=()=>{n({label:"",url:"",order:0,visible:!0,show_in_header:!0,show_in_footer:!1,target_blank:!1})},Q=async(t,a)=>{const o=a||t.label;if(l.find(f=>f.url===t.url)){alert(`A menu item for "${t.url}" already exists.`);return}try{await x.create({label:o,url:t.url,order:l.length,visible:!0,show_in_header:!0,show_in_footer:!1,target_blank:!1}),g(),M(!1),y(null),b("")}catch(f){alert(f.response?.data?.detail||"Failed to add menu item")}},S=()=>$.filter(t=>{const a=u(t.plugin),o=l.some(h=>h.url===t.url);return a&&!o});return A?e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading navigation..."})]})}):e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Navigation Manager"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage header and footer menu items"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:"â† Back to Dashboard"}),e.jsx("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition font-medium",children:"+ Add Menu Item"})]})]}),v&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-600 dark:text-red-400",children:v})}),S().length>0&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Quick Add Plugin Pages"}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Add enabled plugins to your navigation with one click"})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S().map(t=>e.jsx("div",{className:"relative",children:E?.id===t.id?e.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 rounded-lg p-2 shadow-sm",children:[e.jsx("input",{type:"text",value:_,onChange:a=>b(a.target.value),placeholder:t.label,className:"w-32 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsx("button",{onClick:()=>Q(t,_||t.label),className:"px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700",children:"Add"}),e.jsx("button",{onClick:()=>{y(null),b("")},className:"px-2 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"âœ•"})]}):e.jsxs("button",{onClick:()=>{y(t),b(t.label)},className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition text-sm font-medium text-gray-700 dark:text-gray-200",children:[e.jsx("span",{children:t.icon}),e.jsx("span",{children:t.label}),e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"+"})]})},t.id))}),e.jsx("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:'Tip: Click a button to customize the label (e.g., "Games" â†’ "Practice")'})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Order"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Label"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"URL"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Location"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Visible"}),e.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:'No menu items yet. Click "Add Menu Item" to create one.'})}):l.map((t,a)=>e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.order}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("button",{onClick:()=>F(a),disabled:a===0,className:"text-gray-400 hover:text-blue-600 disabled:opacity-30 disabled:cursor-not-allowed",children:"â–²"}),e.jsx("button",{onClick:()=>D(a),disabled:a===l.length-1,className:"text-gray-400 hover:text-blue-600 disabled:opacity-30 disabled:cursor-not-allowed",children:"â–¼"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.parent_id&&e.jsx("span",{className:"text-gray-400",children:"â†³"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.label}),t.parent_id&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 text-xs rounded",children:"Submenu"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.url})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[t.show_in_header&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs rounded",children:"Header"}),t.show_in_footer&&e.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 text-xs rounded",children:"Footer"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${t.visible?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:t.visible?"Visible":"Hidden"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>T(t),className:"px-3 py-1 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition",children:"Edit"}),e.jsx("button",{onClick:()=>z(t.id),className:"px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition",children:"Delete"})]})})]},t.id))})]})}),(I||i)&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i?"Edit Menu Item":"Create Menu Item"})}),e.jsxs("form",{onSubmit:i?P:L,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Label *"}),e.jsx("input",{type:"text",value:r.label,onChange:t=>n({...r,label:t.target.value}),required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Home"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"URL *"}),e.jsx("input",{type:"text",value:r.url,onChange:t=>n({...r,url:t.target.value}),required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"/"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Parent Menu (for dropdown/submenu)"}),e.jsxs("select",{value:r.parent_id||"",onChange:t=>n({...r,parent_id:t.target.value?parseInt(t.target.value):null}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"No parent (top-level menu item)"}),l.filter(t=>!t.parent_id&&(!i||t.id!==i.id)).map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Select a parent to make this a dropdown submenu item"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.visible,onChange:t=>n({...r,visible:t.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Visible"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.show_in_header,onChange:t=>n({...r,show_in_header:t.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show in Header"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.show_in_footer,onChange:t=>n({...r,show_in_footer:t.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show in Footer"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.target_blank,onChange:t=>n({...r,target_blank:t.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Open in New Tab"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:()=>{p(!1),m(null),k()},className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition font-medium",children:i?"Update":"Create"})]})]})]})})]})})};export{O as NavigationManager,O as default};
