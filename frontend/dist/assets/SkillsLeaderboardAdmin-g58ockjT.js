import{r as a,g as m,j as e,T as X,v as I,n as z,e as G,J,Z as w,h as Z}from"./index-smch1bU1.js";import{F as q}from"./filter-8mvCWH_v.js";import{C as B}from"./chevron-up-73WUkVcc.js";import{L as u}from"./loader-2-D9MIupjh.js";import{C as H}from"./clock-DNSf5APC.js";import{M as S}from"./medal-C-gRj-JI.js";const re=()=>{const[L,h]=a.useState([]),[y,p]=a.useState([]),[b,_]=a.useState([]),[C,f]=a.useState(!0),[i,j]=a.useState(!0),[d,T]=a.useState(""),[n,A]=a.useState("it_level"),[s,v]=a.useState(""),[o,$]=a.useState(50),[c,F]=a.useState(!1);a.useEffect(()=>{R()},[]),a.useEffect(()=>{M()},[n,s]),a.useEffect(()=>{k()},[o]);const R=async()=>{try{const r=await m.get("/api/v1/skills/");_(r.data)}catch(r){console.error("Failed to load skills:",r)}},M=async()=>{f(!0);try{let r=`/api/v1/skills/leaderboards/global?leaderboard_type=${n}&limit=100`;s&&(r=`/api/v1/skills/leaderboards/${s}/leaderboard?limit=100`);const t=await m.get(r);h(t.data)}catch(r){console.error("Failed to load leaderboard:",r),h([])}finally{f(!1)}},k=async()=>{j(!0);try{const r=await m.get(`/api/v1/admin/skills/analytics/xp-logs/recent?limit=${o}`);p(r.data)}catch(r){console.error("Failed to load recent activity:",r),p([])}finally{j(!1)}},U=r=>r===1?e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full",children:e.jsx(Z,{className:"w-4 h-4 text-white"})}):r===2?e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-gradient-to-br from-gray-300 to-gray-500 rounded-full",children:e.jsx(S,{className:"w-4 h-4 text-white"})}):r===3?e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full",children:e.jsx(S,{className:"w-4 h-4 text-white"})}):e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-full text-gray-600 dark:text-gray-400 font-medium text-sm",children:r}),D=r=>({quiz:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",tutorial:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",course:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",typing_game:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",achievement:"bg-pink-100 text-pink-700 dark:bg-pink-900/30 dark:text-pink-400"})[r]||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400",E=r=>{const t=new Date(r),P=new Date().getTime()-t.getTime(),l=Math.floor(P/6e4),g=Math.floor(l/60),N=Math.floor(g/24);return l<1?"Just now":l<60?`${l}m ago`:g<24?`${g}h ago`:N<7?`${N}d ago`:t.toLocaleDateString()},x=L.filter(r=>d?r.username.toLowerCase().includes(d.toLowerCase()):!0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(X,{className:"w-7 h-7 text-yellow-500"}),"Skills Leaderboard"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"View IT Level rankings and monitor XP activity"})]}),e.jsxs("button",{onClick:()=>F(!c),className:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),"Filters",c?e.jsx(B,{className:"w-4 h-4"}):e.jsx(I,{className:"w-4 h-4"})]})]}),c&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Search User"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by username...",value:d,onChange:r=>T(r.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Leaderboard Type"}),e.jsxs("select",{value:n,onChange:r=>{A(r.target.value),v("")},className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"it_level",children:"IT Level"}),e.jsx("option",{value:"total_level",children:"Total Level"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Filter by Skill"}),e.jsxs("select",{value:s,onChange:r=>v(r.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"All Skills (Global)"}),b.map(r=>e.jsxs("option",{value:r.slug,children:[r.icon," ",r.name]},r.slug))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Activity Limit"}),e.jsxs("select",{value:o,onChange:r=>$(parseInt(r.target.value)),className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"25",children:"Last 25"}),e.jsx("option",{value:"50",children:"Last 50"}),e.jsx("option",{value:"100",children:"Last 100"}),e.jsx("option",{value:"200",children:"Last 200"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-green-500"}),s?`${b.find(r=>r.slug===s)?.name||"Skill"} Rankings`:"Global Rankings"]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[x.length," users"]})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:C?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-primary"})}):x.length>0?e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:x.map(r=>e.jsxs("div",{className:"flex items-center gap-4 p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[U(r.rank),e.jsx("div",{className:"flex-shrink-0",children:r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:r.username,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-medium",children:r.username[0].toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white truncate",children:r.username}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:r.specialization})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:s?`Lv. ${r.it_level}`:r.it_level}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:s?`${r.total_xp.toLocaleString()} XP`:`Total: ${r.total_level}`})]})]},r.user_id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No users found"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-yellow-500"}),"Recent XP Activity"]}),e.jsx("button",{onClick:k,disabled:i,className:"text-sm text-primary hover:text-primary-dark flex items-center gap-1",children:i?e.jsx(u,{className:"w-4 h-4 animate-spin"}):"Refresh"})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:i?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-primary"})}):y.length>0?e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:y.map(r=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:r.skill_icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.username}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"earned"}),e.jsxs("span",{className:"font-semibold text-green-600 dark:text-green-400",children:["+",r.xp_gained," XP"]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"in"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.skill_name})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${D(r.source_type)}`,children:r.source_type.replace("_"," ")}),r.level_after>r.level_before&&e.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white",children:["Level Up! ",r.level_before," â†’ ",r.level_after]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 ml-auto",children:[e.jsx(H,{className:"w-3 h-3"}),E(r.earned_at)]})]})]})]})},r.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No recent activity"})]})})]})]})]})};export{re as default};
