import{c as B,r as l,j as e,i as G,w as N,n as J,v as q,a4 as z}from"./index-smch1bU1.js";import{L as Q}from"./loader-2-D9MIupjh.js";import{S as V}from"./star-BX-qMkwk.js";import{C as H}from"./chevron-up-73WUkVcc.js";import{P as K}from"./pen-LvGhHwn3.js";import{T as X}from"./trash-2-7shbvHm_.js";const _=B("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),C=["general","tech","programming","quotes","literature","science","business"],S=["easy","medium","hard","expert"],se=()=>{const[m,c]=l.useState([]),[i,P]=l.useState(null),[F,k]=l.useState(!0),[y,E]=l.useState(""),[h,A]=l.useState("all"),[u,T]=l.useState("all"),[L,o]=l.useState(!1),[g,x]=l.useState(null),[p,D]=l.useState(null),[v,U]=l.useState(!1),[r,n]=l.useState({name:"",description:"",difficulty:"medium",category:"general",sentences:"",min_length:20,max_length:200,is_featured:!1,is_active:!0,round_suitable:[1,2,3],difficulty_weight:1,display_order:0});l.useEffect(()=>{I(),b()},[]);const I=async()=>{k(!0);try{const t=await fetch("/api/v1/games/typing/sentence-pools?is_active=",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch sentence pools");const s=await t.json();c(s.pools||[])}catch(t){console.error("Failed to load sentence pools:",t),c([])}finally{k(!1)}},b=async()=>{try{const t=await fetch("/api/v1/games/typing/admin/sentence-pools/stats/summary",{credentials:"include"});if(t.ok){const s=await t.json();P(s)}}catch(t){console.error("Failed to load stats:",t)}},$=t=>{x(t),n({name:t.name,description:t.description||"",difficulty:t.difficulty,category:t.category,sentences:t.sentences.join(`
`),min_length:t.min_length,max_length:t.max_length,is_featured:t.is_featured,is_active:t.is_active,round_suitable:t.round_suitable||[1,2,3],difficulty_weight:t.difficulty_weight,display_order:t.display_order}),o(!0)},M=async t=>{if(confirm("Are you sure you want to delete this sentence pool?"))try{if(!(await fetch(`/api/v1/games/typing/admin/sentence-pools/${t}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to delete sentence pool");c(m.filter(a=>a.id!==t)),b()}catch(s){console.error("Failed to delete sentence pool:",s),alert("Failed to delete sentence pool")}},O=async()=>{const t=r.sentences.split(`
`).map(a=>a.trim()).filter(a=>a.length>0);if(t.length===0){alert("Please add at least one sentence");return}for(const a of t){if(a.length<r.min_length){alert(`Sentence too short: "${a.substring(0,50)}..." (min: ${r.min_length} chars)`);return}if(a.length>r.max_length){alert(`Sentence too long: "${a.substring(0,50)}..." (max: ${r.max_length} chars)`);return}}const s={name:r.name,description:r.description||null,difficulty:r.difficulty,category:r.category,sentences:t,min_length:r.min_length,max_length:r.max_length,is_featured:r.is_featured,is_active:r.is_active,round_suitable:r.round_suitable,difficulty_weight:r.difficulty_weight,display_order:r.display_order};try{if(g){const a=await fetch(`/api/v1/games/typing/admin/sentence-pools/${g.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const d=await a.json();throw new Error(d.detail||"Failed to update sentence pool")}const j=await a.json();c(m.map(d=>d.id===g.id?j:d))}else{const a=await fetch("/api/v1/games/typing/admin/sentence-pools",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const d=await a.json();throw new Error(d.detail||"Failed to create sentence pool")}const j=await a.json();c([...m,j])}o(!1),x(null),f(),b()}catch(a){console.error("Failed to save sentence pool:",a),alert(a instanceof Error?a.message:"Failed to save sentence pool")}},f=()=>{n({name:"",description:"",difficulty:"medium",category:"general",sentences:"",min_length:20,max_length:200,is_featured:!1,is_active:!0,round_suitable:[1,2,3],difficulty_weight:1,display_order:0})},R=t=>{switch(t){case"easy":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";case"hard":return"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400";case"expert":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"}},W=t=>{const s=r.round_suitable;s.includes(t)?s.length>1&&n({...r,round_suitable:s.filter(a=>a!==t)}):n({...r,round_suitable:[...s,t].sort()})},w=m.filter(t=>{if(h!=="all"&&t.difficulty!==h||u!=="all"&&t.category!==u)return!1;if(y){const s=y.toLowerCase();if(!t.name.toLowerCase().includes(s)&&!(t.description||"").toLowerCase().includes(s)&&!t.category.toLowerCase().includes(s))return!1}return!0});return F?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Sentence Pools"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage sentence pools for PVP typing rounds"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>U(!v),className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Stats"]}),e.jsxs("button",{onClick:()=>{x(null),f(),o(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"New Pool"]})]})]}),v&&i&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Pool Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:i.total_pools}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Pools"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-500",children:i.active_pools}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-500",children:Object.keys(i.by_category).length}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Categories"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-500",children:Object.keys(i.by_difficulty).length}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Difficulties"})]})]}),i.top_pools.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Most Used Pools"}),e.jsx("div",{className:"space-y-2",children:i.top_pools.slice(0,5).map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[s+1,". ",t.name]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.times_used," uses | ",t.avg_wpm," WPM | ",t.avg_accuracy,"% acc"]})]},t.id))})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search sentence pools...",value:y,onChange:t=>E(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("select",{value:h,onChange:t=>A(t.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Difficulties"}),S.map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))]}),e.jsxs("select",{value:u,onChange:t=>T(t.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Categories"}),C.map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))]})]}),e.jsx("div",{className:"space-y-4",children:w.map(t=>e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl shadow-sm border ${t.is_active?"border-gray-200 dark:border-gray-700":"border-gray-200 dark:border-gray-700 opacity-60"}`,children:[e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(_,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t.name}),t.is_featured&&e.jsx(V,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),!t.is_active&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-500 rounded",children:"Inactive"})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D(p===t.id?null:t.id),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:p===t.id?e.jsx(H,{className:"w-5 h-5"}):e.jsx(q,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>$(t),className:"p-2 text-gray-400 hover:text-primary hover:bg-primary/10 rounded-lg transition-colors",children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>M(t.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(X,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${R(t.difficulty)}`,children:t.difficulty}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",children:t.category}),e.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:[t.sentence_count," sentences"]}),e.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400",children:[e.jsx(z,{className:"w-3 h-3"}),"Rounds: ",t.round_suitable.join(", ")]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["Used ",t.times_used," times"]}),t.avg_wpm>0&&e.jsxs("span",{children:["Avg WPM: ",t.avg_wpm.toFixed(1)]}),t.avg_accuracy>0&&e.jsxs("span",{children:["Avg Accuracy: ",t.avg_accuracy.toFixed(1),"%"]}),e.jsxs("span",{children:["Weight: ",t.difficulty_weight,"x"]})]})]}),p===t.id&&e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-5 bg-gray-50 dark:bg-gray-900/50",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:["Sentences (",t.sentences.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.sentences.map((s,a)=>e.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("span",{className:"text-gray-400 mr-2",children:[a+1,"."]}),s,e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(",s.length," chars)"]})]},a))})]})]},t.id))}),w.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsx(_,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No sentence pools found"}),e.jsxs("button",{onClick:()=>{x(null),f(),o(!0)},className:"mt-4 inline-flex items-center gap-2 px-4 py-2 text-primary hover:bg-primary/10 rounded-lg transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Create your first pool"]})]}),L&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:g?"Edit Sentence Pool":"Create New Sentence Pool"})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:t=>n({...r,name:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Programming Quotes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsx("select",{value:r.category,onChange:t=>n({...r,category:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:C.map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:r.description,onChange:t=>n({...r,description:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Brief description of this sentence pool"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Difficulty"}),e.jsx("select",{value:r.difficulty,onChange:t=>n({...r,difficulty:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:S.map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Min Length"}),e.jsx("input",{type:"number",min:"5",max:"500",value:r.min_length,onChange:t=>n({...r,min_length:parseInt(t.target.value)||20}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Length"}),e.jsx("input",{type:"number",min:"20",max:"1000",value:r.max_length,onChange:t=>n({...r,max_length:parseInt(t.target.value)||200}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Weight"}),e.jsx("input",{type:"number",min:"0.1",max:"10",step:"0.1",value:r.difficulty_weight,onChange:t=>n({...r,difficulty_weight:parseFloat(t.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Suitable for Rounds"}),e.jsx("div",{className:"flex items-center gap-4",children:[1,2,3].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.round_suitable.includes(t),onChange:()=>W(t),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Round ",t]})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sentences (one per line) *"}),e.jsx("textarea",{value:r.sentences,onChange:t=>n({...r,sentences:t.target.value}),rows:10,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",placeholder:`Enter sentences, one per line...
Each sentence should be between min and max length.`}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.sentences.split(`
`).filter(t=>t.trim()).length," sentences entered | Length range: ",r.min_length,"-",r.max_length," characters"]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.is_featured,onChange:t=>n({...r,is_featured:t.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Featured"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.is_active,onChange:t=>n({...r,is_active:t.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Active"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{o(!1),x(null)},className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:O,disabled:!r.name||!r.sentences.trim(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:opacity-50",children:g?"Save Changes":"Create Pool"})]})]})})]})};export{se as SentencePoolsAdmin,se as default};
